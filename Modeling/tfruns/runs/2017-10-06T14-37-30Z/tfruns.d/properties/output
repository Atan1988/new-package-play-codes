
> #' Trains a simple deep NN on the MNIST dataset.
> #'
> #' Gets to 98.40% test accuracy after 20 epochs (there is *a lot* of margin for
> #' paramet .... [TRUNCATED] 

> # Hyperparameter flags ---------------------------------------------------
> 
> FLAGS <- flags(
+   flag_numeric("dropout1", 0.4),
+   flag_numeric( .... [TRUNCATED] 

> # Data Preparation ---------------------------------------------------
> 
> # The data, shuffled and split between train and test sets
> mnist <- da .... [TRUNCATED] 

> x_train <- mnist$train$x

> y_train <- mnist$train$y

> x_test <- mnist$test$x

> y_test <- mnist$test$y

> # Reshape
> dim(x_train) <- c(nrow(x_train), 784)

> dim(x_test) <- c(nrow(x_test), 784)

> # Transform RGB values into [0,1] range
> x_train <- x_train / 255

> x_test <- x_test / 255

> # Convert class vectors to binary class matrices
> y_train <- to_categorical(y_train, 10)

> y_test <- to_categorical(y_test, 10)

> # Define Model --------------------------------------------------------------
> 
> model <- keras_model_sequential()

> model %>%
+   layer_dense(units = 128, activation = 'relu', input_shape = c(784)) %>%
+   layer_dropout(rate = FLAGS$dropout1) %>%
+   layer_dense(u .... [TRUNCATED] 

> model %>% compile(
+   loss = 'categorical_crossentropy',
+   optimizer = optimizer_rmsprop(lr = 0.003),
+   metrics = c('accuracy')
+ )

> # Training & Evaluation ----------------------------------------------------
> 
> history <- model %>% fit(
+   x_train, y_train,
+   batch_size = 1 .... [TRUNCATED] 
Train on 48000 samples, validate on 12000 samples


Epoch 1/20




  128/48000 [..............................]
 - ETA: 7s - loss: 2.4844 - acc: 0.0469


 1920/48000 [>.............................]
 - ETA: 1s - loss: 1.4339 - acc: 0.5193


 3968/48000 [=>............................]
 - ETA: 1s - loss: 1.1095 - acc: 0.6381


 5888/48000 [==>...........................]
 - ETA: 1s - loss: 0.9419 - acc: 0.6929


 7936/48000 [===>..........................]
 - ETA: 1s - loss: 0.8322 - acc: 0.7310


 9984/48000 [=====>........................]
 - ETA: 1s - loss: 0.7647 - acc: 0.7555


11904/48000 [======>.......................]
 - ETA: 0s - loss: 0.7132 - acc: 0.7724


13824/48000 [=======>......................]
 - ETA: 0s - loss: 0.6743 - acc: 0.7864


15616/48000 [========>.....................]
 - ETA: 0s - loss: 0.6425 - acc: 0.7976


17408/48000 [=========>....................]
 - ETA: 0s - loss: 0.6179 - acc: 0.8062


19328/48000 [===========>..................]
 - ETA: 0s - loss: 0.5978 - acc: 0.8130


21120/48000 [============>.................]
 - ETA: 0s - loss: 0.5774 - acc: 0.8204


23040/48000 [=============>................]
 - ETA: 0s - loss: 0.5598 - acc: 0.8263


24960/48000 [==============>...............]
 - ETA: 0s - loss: 0.5433 - acc: 0.8315


26752/48000 [===============>..............]
 - ETA: 0s - loss: 0.5299 - acc: 0.8358


28672/48000 [================>.............]
 - ETA: 0s - loss: 0.5151 - acc: 0.8407


29952/48000 [=================>............]
 - ETA: 0s - loss: 0.5040 - acc: 0.8439


31744/48000 [==================>...........]
 - ETA: 0s - loss: 0.4918 - acc: 0.8476


33536/48000 [===================>..........]
 - ETA: 0s - loss: 0.4811 - acc: 0.8514


35328/48000 [=====================>........]
 - ETA: 0s - loss: 0.4719 - acc: 0.8545


37248/48000 [======================>.......]
 - ETA: 0s - loss: 0.4640 - acc: 0.8573


39168/48000 [=======================>......]
 - ETA: 0s - loss: 0.4544 - acc: 0.8603


40704/48000 [========================>.....]
 - ETA: 0s - loss: 0.4498 - acc: 0.8617


41984/48000 [=========================>....]
 - ETA: 0s - loss: 0.4444 - acc: 0.8634


43392/48000 [==========================>...]
 - ETA: 0s - loss: 0.4394 - acc: 0.8650


45056/48000 [===========================>..]
 - ETA: 0s - loss: 0.4333 - acc: 0.8670


46976/48000 [============================>.]
 - ETA: 0s - loss: 0.4270 - acc: 0.8689


48000/48000 [==============================]
 - 1s - loss: 0.4241 - acc: 0.8698 - val_loss: 0.1777 - val_acc: 0.9502


Epoch 2/20




  128/48000 [..............................]
 - ETA: 10s - loss: 0.2093 - acc: 0.9062


 1408/48000 [..............................]
 - ETA: 2s - loss: 0.2515 - acc: 0.9261 


 3200/48000 [=>............................]
 - ETA: 1s - loss: 0.2471 - acc: 0.9256


 4992/48000 [==>...........................]
 - ETA: 1s - loss: 0.2683 - acc: 0.9199


 7040/48000 [===>..........................]
 - ETA: 1s - loss: 0.2630 - acc: 0.9193


 9088/48000 [====>.........................]
 - ETA: 1s - loss: 0.2628 - acc: 0.9204


11136/48000 [=====>........................]
 - ETA: 1s - loss: 0.2619 - acc: 0.9219


13184/48000 [=======>......................]
 - ETA: 1s - loss: 0.2583 - acc: 0.9231


15360/48000 [========>.....................]
 - ETA: 0s - loss: 0.2614 - acc: 0.9226


17280/48000 [=========>....................]
 - ETA: 0s - loss: 0.2600 - acc: 0.9225


19456/48000 [===========>..................]
 - ETA: 0s - loss: 0.2577 - acc: 0.9237


21504/48000 [============>.................]
 - ETA: 0s - loss: 0.2578 - acc: 0.9238


23552/48000 [=============>................]
 - ETA: 0s - loss: 0.2561 - acc: 0.9243


25728/48000 [===============>..............]
 - ETA: 0s - loss: 0.2545 - acc: 0.9249


27776/48000 [================>.............]
 - ETA: 0s - loss: 0.2547 - acc: 0.9256


29824/48000 [=================>............]
 - ETA: 0s - loss: 0.2541 - acc: 0.9255


31872/48000 [==================>...........]
 - ETA: 0s - loss: 0.2506 - acc: 0.9266


33920/48000 [====================>.........]
 - ETA: 0s - loss: 0.2504 - acc: 0.9272


36096/48000 [=====================>........]
 - ETA: 0s - loss: 0.2487 - acc: 0.9277


38144/48000 [======================>.......]
 - ETA: 0s - loss: 0.2493 - acc: 0.9276


40192/48000 [========================>.....]
 - ETA: 0s - loss: 0.2478 - acc: 0.9277


42112/48000 [=========================>....]
 - ETA: 0s - loss: 0.2470 - acc: 0.9282


44160/48000 [==========================>...]
 - ETA: 0s - loss: 0.2468 - acc: 0.9280


46208/48000 [===========================>..]
 - ETA: 0s - loss: 0.2466 - acc: 0.9283


48000/48000 [==============================]
 - 1s - loss: 0.2458 - acc: 0.9286 - val_loss: 0.1314 - val_acc: 0.9623


Epoch 3/20




  128/48000 [..............................]
 - ETA: 8s - loss: 0.1900 - acc: 0.9219


 1536/48000 [..............................]
 - ETA: 2s - loss: 0.1996 - acc: 0.9342


 3328/48000 [=>............................]
 - ETA: 1s - loss: 0.2103 - acc: 0.9384


 5376/48000 [==>...........................]
 - ETA: 1s - loss: 0.2098 - acc: 0.9392


 7424/48000 [===>..........................]
 - ETA: 1s - loss: 0.2006 - acc: 0.9410


 9472/48000 [====>.........................]
 - ETA: 1s - loss: 0.2043 - acc: 0.9408


11520/48000 [======>.......................]
 - ETA: 1s - loss: 0.2066 - acc: 0.9399


13440/48000 [=======>......................]
 - ETA: 0s - loss: 0.2061 - acc: 0.9398


15104/48000 [========>.....................]
 - ETA: 0s - loss: 0.2113 - acc: 0.9385


16896/48000 [=========>....................]
 - ETA: 0s - loss: 0.2080 - acc: 0.9397


18432/48000 [==========>...................]
 - ETA: 0s - loss: 0.2080 - acc: 0.9398


20608/48000 [===========>..................]
 - ETA: 0s - loss: 0.2071 - acc: 0.9402


22656/48000 [=============>................]
 - ETA: 0s - loss: 0.2084 - acc: 0.9401


24704/48000 [==============>...............]
 - ETA: 0s - loss: 0.2124 - acc: 0.9392


26880/48000 [===============>..............]
 - ETA: 0s - loss: 0.2126 - acc: 0.9393


28928/48000 [=================>............]
 - ETA: 0s - loss: 0.2145 - acc: 0.9388


30976/48000 [==================>...........]
 - ETA: 0s - loss: 0.2127 - acc: 0.9393


33024/48000 [===================>..........]
 - ETA: 0s - loss: 0.2119 - acc: 0.9395


35200/48000 [=====================>........]
 - ETA: 0s - loss: 0.2093 - acc: 0.9402


37248/48000 [======================>.......]
 - ETA: 0s - loss: 0.2076 - acc: 0.9405


39296/48000 [=======================>......]
 - ETA: 0s - loss: 0.2076 - acc: 0.9408


41344/48000 [========================>.....]
 - ETA: 0s - loss: 0.2095 - acc: 0.9402


43520/48000 [==========================>...]
 - ETA: 0s - loss: 0.2090 - acc: 0.9400


45568/48000 [===========================>..]
 - ETA: 0s - loss: 0.2084 - acc: 0.9402


47616/48000 [============================>.]
 - ETA: 0s - loss: 0.2072 - acc: 0.9406


48000/48000 [==============================]
 - 1s - loss: 0.2068 - acc: 0.9407 - val_loss: 0.1265 - val_acc: 0.9658


Epoch 4/20




  128/48000 [..............................]
 - ETA: 5s - loss: 0.1281 - acc: 0.9609


 1024/48000 [..............................]
 - ETA: 3s - loss: 0.2094 - acc: 0.9414


 2688/48000 [>.............................]
 - ETA: 1s - loss: 0.1857 - acc: 0.9472


 4608/48000 [=>............................]
 - ETA: 1s - loss: 0.1910 - acc: 0.9473


 6656/48000 [===>..........................]
 - ETA: 1s - loss: 0.1886 - acc: 0.9452


 8704/48000 [====>.........................]
 - ETA: 1s - loss: 0.1886 - acc: 0.9444


10880/48000 [=====>........................]
 - ETA: 1s - loss: 0.1903 - acc: 0.9441


12928/48000 [=======>......................]
 - ETA: 1s - loss: 0.1914 - acc: 0.9445


15104/48000 [========>.....................]
 - ETA: 0s - loss: 0.1881 - acc: 0.9456


17280/48000 [=========>....................]
 - ETA: 0s - loss: 0.1878 - acc: 0.9456


19328/48000 [===========>..................]
 - ETA: 0s - loss: 0.1881 - acc: 0.9458


21376/48000 [============>.................]
 - ETA: 0s - loss: 0.1860 - acc: 0.9467


23296/48000 [=============>................]
 - ETA: 0s - loss: 0.1872 - acc: 0.9467


25344/48000 [==============>...............]
 - ETA: 0s - loss: 0.1886 - acc: 0.9463


27520/48000 [================>.............]
 - ETA: 0s - loss: 0.1885 - acc: 0.9463


29568/48000 [=================>............]
 - ETA: 0s - loss: 0.1873 - acc: 0.9471


31616/48000 [==================>...........]
 - ETA: 0s - loss: 0.1875 - acc: 0.9470


33664/48000 [====================>.........]
 - ETA: 0s - loss: 0.1878 - acc: 0.9469


35840/48000 [=====================>........]
 - ETA: 0s - loss: 0.1876 - acc: 0.9472


37888/48000 [======================>.......]
 - ETA: 0s - loss: 0.1869 - acc: 0.9472


40064/48000 [========================>.....]
 - ETA: 0s - loss: 0.1857 - acc: 0.9474


42112/48000 [=========================>....]
 - ETA: 0s - loss: 0.1865 - acc: 0.9472


44160/48000 [==========================>...]
 - ETA: 0s - loss: 0.1873 - acc: 0.9472


46336/48000 [===========================>..]
 - ETA: 0s - loss: 0.1877 - acc: 0.9472


48000/48000 [==============================]
 - 1s - loss: 0.1877 - acc: 0.9473 - val_loss: 0.1217 - val_acc: 0.9673


Epoch 5/20




  128/48000 [..............................]
 - ETA: 6s - loss: 0.2890 - acc: 0.9141


 1280/48000 [..............................]
 - ETA: 2s - loss: 0.1429 - acc: 0.9578


 3200/48000 [=>............................]
 - ETA: 1s - loss: 0.1424 - acc: 0.9572


 5248/48000 [==>...........................]
 - ETA: 1s - loss: 0.1464 - acc: 0.9546


 7168/48000 [===>..........................]
 - ETA: 1s - loss: 0.1523 - acc: 0.9540


 9216/48000 [====>.........................]
 - ETA: 1s - loss: 0.1523 - acc: 0.9540


11264/48000 [======>.......................]
 - ETA: 1s - loss: 0.1589 - acc: 0.9529


13056/48000 [=======>......................]
 - ETA: 0s - loss: 0.1612 - acc: 0.9529


15104/48000 [========>.....................]
 - ETA: 0s - loss: 0.1673 - acc: 0.9522


17152/48000 [=========>....................]
 - ETA: 0s - loss: 0.1689 - acc: 0.9511


19200/48000 [===========>..................]
 - ETA: 0s - loss: 0.1663 - acc: 0.9521


21248/48000 [============>.................]
 - ETA: 0s - loss: 0.1690 - acc: 0.9521


23168/48000 [=============>................]
 - ETA: 0s - loss: 0.1726 - acc: 0.9514


25088/48000 [==============>...............]
 - ETA: 0s - loss: 0.1718 - acc: 0.9515


27136/48000 [===============>..............]
 - ETA: 0s - loss: 0.1722 - acc: 0.9514


29184/48000 [=================>............]
 - ETA: 0s - loss: 0.1716 - acc: 0.9514


31232/48000 [==================>...........]
 - ETA: 0s - loss: 0.1736 - acc: 0.9510


33280/48000 [===================>..........]
 - ETA: 0s - loss: 0.1755 - acc: 0.9510


35328/48000 [=====================>........]
 - ETA: 0s - loss: 0.1754 - acc: 0.9511


37120/48000 [======================>.......]
 - ETA: 0s - loss: 0.1752 - acc: 0.9509


38912/48000 [=======================>......]
 - ETA: 0s - loss: 0.1766 - acc: 0.9508


40832/48000 [========================>.....]
 - ETA: 0s - loss: 0.1758 - acc: 0.9510


42880/48000 [=========================>....]
 - ETA: 0s - loss: 0.1755 - acc: 0.9509


44928/48000 [===========================>..]
 - ETA: 0s - loss: 0.1749 - acc: 0.9511


46976/48000 [============================>.]
 - ETA: 0s - loss: 0.1764 - acc: 0.9510


48000/48000 [==============================]
 - 1s - loss: 0.1775 - acc: 0.9508 - val_loss: 0.1181 - val_acc: 0.9683


Epoch 6/20




  128/48000 [..............................]
 - ETA: 4s - loss: 0.2094 - acc: 0.9375


  896/48000 [..............................]
 - ETA: 3s - loss: 0.1332 - acc: 0.9643


 2560/48000 [>.............................]
 - ETA: 2s - loss: 0.1658 - acc: 0.9539


 4352/48000 [=>............................]
 - ETA: 1s - loss: 0.1758 - acc: 0.9515


 6400/48000 [===>..........................]
 - ETA: 1s - loss: 0.1669 - acc: 0.9527


 8576/48000 [====>.........................]
 - ETA: 1s - loss: 0.1641 - acc: 0.9528


10624/48000 [=====>........................]
 - ETA: 1s - loss: 0.1693 - acc: 0.9518


12672/48000 [======>.......................]
 - ETA: 1s - loss: 0.1667 - acc: 0.9519


14720/48000 [========>.....................]
 - ETA: 0s - loss: 0.1683 - acc: 0.9516


16768/48000 [=========>....................]
 - ETA: 0s - loss: 0.1711 - acc: 0.9513


18816/48000 [==========>...................]
 - ETA: 0s - loss: 0.1682 - acc: 0.9521


20736/48000 [===========>..................]
 - ETA: 0s - loss: 0.1717 - acc: 0.9519


22784/48000 [=============>................]
 - ETA: 0s - loss: 0.1726 - acc: 0.9518


24832/48000 [==============>...............]
 - ETA: 0s - loss: 0.1727 - acc: 0.9521


26880/48000 [===============>..............]
 - ETA: 0s - loss: 0.1707 - acc: 0.9523


28928/48000 [=================>............]
 - ETA: 0s - loss: 0.1717 - acc: 0.9519


30976/48000 [==================>...........]
 - ETA: 0s - loss: 0.1710 - acc: 0.9525


33024/48000 [===================>..........]
 - ETA: 0s - loss: 0.1688 - acc: 0.9531


35072/48000 [====================>.........]
 - ETA: 0s - loss: 0.1696 - acc: 0.9529


36992/48000 [======================>.......]
 - ETA: 0s - loss: 0.1705 - acc: 0.9526


39040/48000 [=======================>......]
 - ETA: 0s - loss: 0.1712 - acc: 0.9525


41088/48000 [========================>.....]
 - ETA: 0s - loss: 0.1706 - acc: 0.9524


43136/48000 [=========================>....]
 - ETA: 0s - loss: 0.1690 - acc: 0.9528


45184/48000 [===========================>..]
 - ETA: 0s - loss: 0.1688 - acc: 0.9531


47232/48000 [============================>.]
 - ETA: 0s - loss: 0.1689 - acc: 0.9531


48000/48000 [==============================]
 - 1s - loss: 0.1697 - acc: 0.9529 - val_loss: 0.1195 - val_acc: 0.9686


Epoch 7/20




  128/48000 [..............................]
 - ETA: 3s - loss: 0.1672 - acc: 0.9141


 1536/48000 [..............................]
 - ETA: 1s - loss: 0.1694 - acc: 0.9512


 3456/48000 [=>............................]
 - ETA: 1s - loss: 0.1472 - acc: 0.9554


 5504/48000 [==>...........................]
 - ETA: 1s - loss: 0.1449 - acc: 0.9557


 7552/48000 [===>..........................]
 - ETA: 1s - loss: 0.1476 - acc: 0.9568


 9600/48000 [=====>........................]
 - ETA: 1s - loss: 0.1531 - acc: 0.9566


11520/48000 [======>.......................]
 - ETA: 1s - loss: 0.1533 - acc: 0.9570


13568/48000 [=======>......................]
 - ETA: 0s - loss: 0.1546 - acc: 0.9567


15104/48000 [========>.....................]
 - ETA: 0s - loss: 0.1534 - acc: 0.9568


16768/48000 [=========>....................]
 - ETA: 0s - loss: 0.1554 - acc: 0.9562


18560/48000 [==========>...................]
 - ETA: 0s - loss: 0.1550 - acc: 0.9565


20608/48000 [===========>..................]
 - ETA: 0s - loss: 0.1566 - acc: 0.9570


22784/48000 [=============>................]
 - ETA: 0s - loss: 0.1545 - acc: 0.9569


24832/48000 [==============>...............]
 - ETA: 0s - loss: 0.1545 - acc: 0.9567


27008/48000 [===============>..............]
 - ETA: 0s - loss: 0.1553 - acc: 0.9568


29056/48000 [=================>............]
 - ETA: 0s - loss: 0.1564 - acc: 0.9565


30976/48000 [==================>...........]
 - ETA: 0s - loss: 0.1571 - acc: 0.9562


33152/48000 [===================>..........]
 - ETA: 0s - loss: 0.1589 - acc: 0.9560


35200/48000 [=====================>........]
 - ETA: 0s - loss: 0.1581 - acc: 0.9564


37120/48000 [======================>.......]
 - ETA: 0s - loss: 0.1562 - acc: 0.9569


38912/48000 [=======================>......]
 - ETA: 0s - loss: 0.1572 - acc: 0.9567


40832/48000 [========================>.....]
 - ETA: 0s - loss: 0.1583 - acc: 0.9565


42880/48000 [=========================>....]
 - ETA: 0s - loss: 0.1591 - acc: 0.9563


44928/48000 [===========================>..]
 - ETA: 0s - loss: 0.1597 - acc: 0.9560


46976/48000 [============================>.]
 - ETA: 0s - loss: 0.1606 - acc: 0.9559


48000/48000 [==============================]
 - 1s - loss: 0.1605 - acc: 0.9559 - val_loss: 0.1056 - val_acc: 0.9713


Epoch 8/20




  128/48000 [..............................]
 - ETA: 6s - loss: 0.2546 - acc: 0.9688


 1536/48000 [..............................]
 - ETA: 2s - loss: 0.1705 - acc: 0.9544


 3328/48000 [=>............................]
 - ETA: 1s - loss: 0.1503 - acc: 0.9585


 4992/48000 [==>...........................]
 - ETA: 1s - loss: 0.1644 - acc: 0.9547


 6784/48000 [===>..........................]
 - ETA: 1s - loss: 0.1530 - acc: 0.9584


 8704/48000 [====>.........................]
 - ETA: 1s - loss: 0.1506 - acc: 0.9593


10752/48000 [=====>........................]
 - ETA: 1s - loss: 0.1532 - acc: 0.9589


12800/48000 [=======>......................]
 - ETA: 1s - loss: 0.1521 - acc: 0.9596


14848/48000 [========>.....................]
 - ETA: 0s - loss: 0.1571 - acc: 0.9586


16896/48000 [=========>....................]
 - ETA: 0s - loss: 0.1587 - acc: 0.9579


18816/48000 [==========>...................]
 - ETA: 0s - loss: 0.1584 - acc: 0.9576


20736/48000 [===========>..................]
 - ETA: 0s - loss: 0.1575 - acc: 0.9576


22784/48000 [=============>................]
 - ETA: 0s - loss: 0.1571 - acc: 0.9578


24576/48000 [==============>...............]
 - ETA: 0s - loss: 0.1552 - acc: 0.9583


26496/48000 [===============>..............]
 - ETA: 0s - loss: 0.1550 - acc: 0.9584


28288/48000 [================>.............]
 - ETA: 0s - loss: 0.1567 - acc: 0.9579


30336/48000 [=================>............]
 - ETA: 0s - loss: 0.1576 - acc: 0.9579


32384/48000 [===================>..........]
 - ETA: 0s - loss: 0.1573 - acc: 0.9581


34432/48000 [====================>.........]
 - ETA: 0s - loss: 0.1567 - acc: 0.9577


36480/48000 [=====================>........]
 - ETA: 0s - loss: 0.1593 - acc: 0.9575


38400/48000 [=======================>......]
 - ETA: 0s - loss: 0.1573 - acc: 0.9576


40448/48000 [========================>.....]
 - ETA: 0s - loss: 0.1566 - acc: 0.9577


42496/48000 [=========================>....]
 - ETA: 0s - loss: 0.1562 - acc: 0.9577


44544/48000 [==========================>...]
 - ETA: 0s - loss: 0.1562 - acc: 0.9577


46464/48000 [============================>.]
 - ETA: 0s - loss: 0.1561 - acc: 0.9578


48000/48000 [==============================]
 - 1s - loss: 0.1562 - acc: 0.9580 - val_loss: 0.1184 - val_acc: 0.9706


Epoch 9/20




  128/48000 [..............................]
 - ETA: 2s - loss: 0.2342 - acc: 0.9375


 1280/48000 [..............................]
 - ETA: 2s - loss: 0.1819 - acc: 0.9563


 3200/48000 [=>............................]
 - ETA: 1s - loss: 0.1543 - acc: 0.9622


 5248/48000 [==>...........................]
 - ETA: 1s - loss: 0.1483 - acc: 0.9611


 7168/48000 [===>..........................]
 - ETA: 1s - loss: 0.1462 - acc: 0.9618


 9216/48000 [====>.........................]
 - ETA: 1s - loss: 0.1482 - acc: 0.9614


11264/48000 [======>.......................]
 - ETA: 1s - loss: 0.1535 - acc: 0.9592


13312/48000 [=======>......................]
 - ETA: 0s - loss: 0.1502 - acc: 0.9594


15360/48000 [========>.....................]
 - ETA: 0s - loss: 0.1518 - acc: 0.9592


17152/48000 [=========>....................]
 - ETA: 0s - loss: 0.1505 - acc: 0.9595


19200/48000 [===========>..................]
 - ETA: 0s - loss: 0.1488 - acc: 0.9598


21248/48000 [============>.................]
 - ETA: 0s - loss: 0.1513 - acc: 0.9590


23296/48000 [=============>................]
 - ETA: 0s - loss: 0.1522 - acc: 0.9590


25344/48000 [==============>...............]
 - ETA: 0s - loss: 0.1551 - acc: 0.9585


27136/48000 [===============>..............]
 - ETA: 0s - loss: 0.1556 - acc: 0.9583


28800/48000 [=================>............]
 - ETA: 0s - loss: 0.1543 - acc: 0.9587


30848/48000 [==================>...........]
 - ETA: 0s - loss: 0.1537 - acc: 0.9589


32896/48000 [===================>..........]
 - ETA: 0s - loss: 0.1531 - acc: 0.9588


34944/48000 [====================>.........]
 - ETA: 0s - loss: 0.1528 - acc: 0.9590


36736/48000 [=====================>........]
 - ETA: 0s - loss: 0.1516 - acc: 0.9592


38400/48000 [=======================>......]
 - ETA: 0s - loss: 0.1531 - acc: 0.9590


40192/48000 [========================>.....]
 - ETA: 0s - loss: 0.1524 - acc: 0.9593


42112/48000 [=========================>....]
 - ETA: 0s - loss: 0.1539 - acc: 0.9589


44032/48000 [==========================>...]
 - ETA: 0s - loss: 0.1551 - acc: 0.9585


45952/48000 [===========================>..]
 - ETA: 0s - loss: 0.1554 - acc: 0.9582


47872/48000 [============================>.]
 - ETA: 0s - loss: 0.1568 - acc: 0.9580


48000/48000 [==============================]
 - 1s - loss: 0.1565 - acc: 0.9581 - val_loss: 0.1163 - val_acc: 0.9736


Epoch 10/20




  128/48000 [..............................]
 - ETA: 2s - loss: 0.0582 - acc: 0.9766


 1408/48000 [..............................]
 - ETA: 1s - loss: 0.1497 - acc: 0.9567


 2688/48000 [>.............................]
 - ETA: 1s - loss: 0.1454 - acc: 0.9594


 4480/48000 [=>............................]
 - ETA: 1s - loss: 0.1398 - acc: 0.9594


 6272/48000 [==>...........................]
 - ETA: 1s - loss: 0.1372 - acc: 0.9593


 7936/48000 [===>..........................]
 - ETA: 1s - loss: 0.1409 - acc: 0.9592


 9728/48000 [=====>........................]
 - ETA: 1s - loss: 0.1432 - acc: 0.9591


11264/48000 [======>.......................]
 - ETA: 1s - loss: 0.1401 - acc: 0.9606


13184/48000 [=======>......................]
 - ETA: 1s - loss: 0.1366 - acc: 0.9612


15232/48000 [========>.....................]
 - ETA: 1s - loss: 0.1403 - acc: 0.9611


17280/48000 [=========>....................]
 - ETA: 0s - loss: 0.1439 - acc: 0.9600


19200/48000 [===========>..................]
 - ETA: 0s - loss: 0.1414 - acc: 0.9607


21248/48000 [============>.................]
 - ETA: 0s - loss: 0.1416 - acc: 0.9605


23168/48000 [=============>................]
 - ETA: 0s - loss: 0.1432 - acc: 0.9605


24448/48000 [==============>...............]
 - ETA: 0s - loss: 0.1439 - acc: 0.9604


26112/48000 [===============>..............]
 - ETA: 0s - loss: 0.1442 - acc: 0.9606


27520/48000 [================>.............]
 - ETA: 0s - loss: 0.1436 - acc: 0.9608


28928/48000 [=================>............]
 - ETA: 0s - loss: 0.1460 - acc: 0.9606


30464/48000 [==================>...........]
 - ETA: 0s - loss: 0.1479 - acc: 0.9603


32000/48000 [===================>..........]
 - ETA: 0s - loss: 0.1489 - acc: 0.9603


33792/48000 [====================>.........]
 - ETA: 0s - loss: 0.1513 - acc: 0.9598


35840/48000 [=====================>........]
 - ETA: 0s - loss: 0.1527 - acc: 0.9595


37760/48000 [======================>.......]
 - ETA: 0s - loss: 0.1521 - acc: 0.9595


39808/48000 [=======================>......]
 - ETA: 0s - loss: 0.1539 - acc: 0.9592


41728/48000 [=========================>....]
 - ETA: 0s - loss: 0.1528 - acc: 0.9596


43776/48000 [==========================>...]
 - ETA: 0s - loss: 0.1528 - acc: 0.9599


45824/48000 [===========================>..]
 - ETA: 0s - loss: 0.1534 - acc: 0.9601


47872/48000 [============================>.]
 - ETA: 0s - loss: 0.1530 - acc: 0.9600


48000/48000 [==============================]
 - 1s - loss: 0.1526 - acc: 0.9600 - val_loss: 0.1124 - val_acc: 0.9732


Epoch 11/20




  128/48000 [..............................]
 - ETA: 4s - loss: 0.0439 - acc: 0.9844


 1536/48000 [..............................]
 - ETA: 1s - loss: 0.0818 - acc: 0.9681


 3456/48000 [=>............................]
 - ETA: 1s - loss: 0.0995 - acc: 0.9679


 5376/48000 [==>...........................]
 - ETA: 1s - loss: 0.1136 - acc: 0.9678


 7296/48000 [===>..........................]
 - ETA: 1s - loss: 0.1159 - acc: 0.9666


 9344/48000 [====>.........................]
 - ETA: 1s - loss: 0.1225 - acc: 0.9648


11392/48000 [======>.......................]
 - ETA: 1s - loss: 0.1272 - acc: 0.9645


13440/48000 [=======>......................]
 - ETA: 0s - loss: 0.1319 - acc: 0.9639


15488/48000 [========>.....................]
 - ETA: 0s - loss: 0.1328 - acc: 0.9638


17536/48000 [=========>....................]
 - ETA: 0s - loss: 0.1365 - acc: 0.9632


19456/48000 [===========>..................]
 - ETA: 0s - loss: 0.1399 - acc: 0.9626


21376/48000 [============>.................]
 - ETA: 0s - loss: 0.1412 - acc: 0.9623


23296/48000 [=============>................]
 - ETA: 0s - loss: 0.1439 - acc: 0.9619


25216/48000 [==============>...............]
 - ETA: 0s - loss: 0.1447 - acc: 0.9618


27136/48000 [===============>..............]
 - ETA: 0s - loss: 0.1470 - acc: 0.9611


29056/48000 [=================>............]
 - ETA: 0s - loss: 0.1493 - acc: 0.9603


30976/48000 [==================>...........]
 - ETA: 0s - loss: 0.1494 - acc: 0.9599


32896/48000 [===================>..........]
 - ETA: 0s - loss: 0.1484 - acc: 0.9605


34816/48000 [====================>.........]
 - ETA: 0s - loss: 0.1485 - acc: 0.9605


36608/48000 [=====================>........]
 - ETA: 0s - loss: 0.1487 - acc: 0.9606


38400/48000 [=======================>......]
 - ETA: 0s - loss: 0.1485 - acc: 0.9608


40320/48000 [========================>.....]
 - ETA: 0s - loss: 0.1487 - acc: 0.9609


42240/48000 [=========================>....]
 - ETA: 0s - loss: 0.1500 - acc: 0.9607


44288/48000 [==========================>...]
 - ETA: 0s - loss: 0.1502 - acc: 0.9606


46336/48000 [===========================>..]
 - ETA: 0s - loss: 0.1504 - acc: 0.9606


48000/48000 [==============================]
 - 1s - loss: 0.1513 - acc: 0.9603 - val_loss: 0.1136 - val_acc: 0.9721


Epoch 12/20




  128/48000 [..............................]
 - ETA: 3s - loss: 0.1311 - acc: 0.9453


 1152/48000 [..............................]
 - ETA: 2s - loss: 0.1368 - acc: 0.9661


 2816/48000 [>.............................]
 - ETA: 1s - loss: 0.1280 - acc: 0.9648


 4608/48000 [=>............................]
 - ETA: 1s - loss: 0.1306 - acc: 0.9651


 6656/48000 [===>..........................]
 - ETA: 1s - loss: 0.1238 - acc: 0.9678


 8576/48000 [====>.........................]
 - ETA: 1s - loss: 0.1327 - acc: 0.9667


10624/48000 [=====>........................]
 - ETA: 1s - loss: 0.1348 - acc: 0.9655


12672/48000 [======>.......................]
 - ETA: 1s - loss: 0.1353 - acc: 0.9646


14720/48000 [========>.....................]
 - ETA: 0s - loss: 0.1378 - acc: 0.9645


16768/48000 [=========>....................]
 - ETA: 0s - loss: 0.1408 - acc: 0.9650


18816/48000 [==========>...................]
 - ETA: 0s - loss: 0.1396 - acc: 0.9649


20864/48000 [============>.................]
 - ETA: 0s - loss: 0.1405 - acc: 0.9642


22784/48000 [=============>................]
 - ETA: 0s - loss: 0.1424 - acc: 0.9631


24832/48000 [==============>...............]
 - ETA: 0s - loss: 0.1412 - acc: 0.9632


26880/48000 [===============>..............]
 - ETA: 0s - loss: 0.1446 - acc: 0.9625


28928/48000 [=================>............]
 - ETA: 0s - loss: 0.1458 - acc: 0.9621


30976/48000 [==================>...........]
 - ETA: 0s - loss: 0.1460 - acc: 0.9621


33024/48000 [===================>..........]
 - ETA: 0s - loss: 0.1485 - acc: 0.9616


35072/48000 [====================>.........]
 - ETA: 0s - loss: 0.1500 - acc: 0.9611


37120/48000 [======================>.......]
 - ETA: 0s - loss: 0.1499 - acc: 0.9612


39040/48000 [=======================>......]
 - ETA: 0s - loss: 0.1501 - acc: 0.9610


41088/48000 [========================>.....]
 - ETA: 0s - loss: 0.1495 - acc: 0.9610


42880/48000 [=========================>....]
 - ETA: 0s - loss: 0.1502 - acc: 0.9609


44800/48000 [===========================>..]
 - ETA: 0s - loss: 0.1507 - acc: 0.9607


46848/48000 [============================>.]
 - ETA: 0s - loss: 0.1491 - acc: 0.9610


48000/48000 [==============================]
 - 1s - loss: 0.1505 - acc: 0.9606 - val_loss: 0.1116 - val_acc: 0.9736


Epoch 13/20




  128/48000 [..............................]
 - ETA: 3s - loss: 0.1397 - acc: 0.9453


 1536/48000 [..............................]
 - ETA: 1s - loss: 0.0989 - acc: 0.9674


 3200/48000 [=>............................]
 - ETA: 1s - loss: 0.1125 - acc: 0.9659


 5248/48000 [==>...........................]
 - ETA: 1s - loss: 0.1275 - acc: 0.9646


 7168/48000 [===>..........................]
 - ETA: 1s - loss: 0.1377 - acc: 0.9636


 9088/48000 [====>.........................]
 - ETA: 1s - loss: 0.1392 - acc: 0.9636


11008/48000 [=====>........................]
 - ETA: 1s - loss: 0.1368 - acc: 0.9644


12928/48000 [=======>......................]
 - ETA: 0s - loss: 0.1421 - acc: 0.9640


14848/48000 [========>.....................]
 - ETA: 0s - loss: 0.1423 - acc: 0.9641


16896/48000 [=========>....................]
 - ETA: 0s - loss: 0.1450 - acc: 0.9639


18688/48000 [==========>...................]
 - ETA: 0s - loss: 0.1473 - acc: 0.9632


20608/48000 [===========>..................]
 - ETA: 0s - loss: 0.1459 - acc: 0.9629


22528/48000 [=============>................]
 - ETA: 0s - loss: 0.1448 - acc: 0.9625


24448/48000 [==============>...............]
 - ETA: 0s - loss: 0.1462 - acc: 0.9623


26240/48000 [===============>..............]
 - ETA: 0s - loss: 0.1477 - acc: 0.9622


28160/48000 [================>.............]
 - ETA: 0s - loss: 0.1488 - acc: 0.9621


30080/48000 [=================>............]
 - ETA: 0s - loss: 0.1491 - acc: 0.9618


32000/48000 [===================>..........]
 - ETA: 0s - loss: 0.1494 - acc: 0.9616


33920/48000 [====================>.........]
 - ETA: 0s - loss: 0.1489 - acc: 0.9616


35840/48000 [=====================>........]
 - ETA: 0s - loss: 0.1492 - acc: 0.9615


37632/48000 [======================>.......]
 - ETA: 0s - loss: 0.1482 - acc: 0.9618


39424/48000 [=======================>......]
 - ETA: 0s - loss: 0.1471 - acc: 0.9620


41088/48000 [========================>.....]
 - ETA: 0s - loss: 0.1467 - acc: 0.9621


43136/48000 [=========================>....]
 - ETA: 0s - loss: 0.1458 - acc: 0.9621


44672/48000 [==========================>...]
 - ETA: 0s - loss: 0.1470 - acc: 0.9619


46336/48000 [===========================>..]
 - ETA: 0s - loss: 0.1466 - acc: 0.9620


48000/48000 [==============================]
 - 1s - loss: 0.1486 - acc: 0.9617 - val_loss: 0.1135 - val_acc: 0.9742


Epoch 14/20




  128/48000 [..............................]
 - ETA: 5s - loss: 0.0528 - acc: 0.9844


 1280/48000 [..............................]
 - ETA: 2s - loss: 0.1424 - acc: 0.9625


 2944/48000 [>.............................]
 - ETA: 1s - loss: 0.1214 - acc: 0.9660


 4608/48000 [=>............................]
 - ETA: 1s - loss: 0.1368 - acc: 0.9629


 6656/48000 [===>..........................]
 - ETA: 1s - loss: 0.1326 - acc: 0.9623


 8704/48000 [====>.........................]
 - ETA: 1s - loss: 0.1380 - acc: 0.9608


10752/48000 [=====>........................]
 - ETA: 1s - loss: 0.1398 - acc: 0.9621


12800/48000 [=======>......................]
 - ETA: 1s - loss: 0.1429 - acc: 0.9616


14848/48000 [========>.....................]
 - ETA: 0s - loss: 0.1425 - acc: 0.9611


16896/48000 [=========>....................]
 - ETA: 0s - loss: 0.1451 - acc: 0.9610


18944/48000 [==========>...................]
 - ETA: 0s - loss: 0.1423 - acc: 0.9616


20992/48000 [============>.................]
 - ETA: 0s - loss: 0.1411 - acc: 0.9620


23040/48000 [=============>................]
 - ETA: 0s - loss: 0.1421 - acc: 0.9618


25088/48000 [==============>...............]
 - ETA: 0s - loss: 0.1439 - acc: 0.9619


27136/48000 [===============>..............]
 - ETA: 0s - loss: 0.1446 - acc: 0.9618


29184/48000 [=================>............]
 - ETA: 0s - loss: 0.1449 - acc: 0.9616


31104/48000 [==================>...........]
 - ETA: 0s - loss: 0.1444 - acc: 0.9618


33152/48000 [===================>..........]
 - ETA: 0s - loss: 0.1458 - acc: 0.9619


35072/48000 [====================>.........]
 - ETA: 0s - loss: 0.1455 - acc: 0.9619


37120/48000 [======================>.......]
 - ETA: 0s - loss: 0.1482 - acc: 0.9616


39168/48000 [=======================>......]
 - ETA: 0s - loss: 0.1483 - acc: 0.9617


41088/48000 [========================>.....]
 - ETA: 0s - loss: 0.1488 - acc: 0.9616


43136/48000 [=========================>....]
 - ETA: 0s - loss: 0.1486 - acc: 0.9617


45184/48000 [===========================>..]
 - ETA: 0s - loss: 0.1489 - acc: 0.9617


47232/48000 [============================>.]
 - ETA: 0s - loss: 0.1485 - acc: 0.9618


48000/48000 [==============================]
 - 1s - loss: 0.1484 - acc: 0.9618 - val_loss: 0.1197 - val_acc: 0.9733


Epoch 15/20




  128/48000 [..............................]
 - ETA: 6s - loss: 0.1802 - acc: 0.9688


 1024/48000 [..............................]
 - ETA: 3s - loss: 0.1801 - acc: 0.9580


 2944/48000 [>.............................]
 - ETA: 1s - loss: 0.1525 - acc: 0.9582


 4992/48000 [==>...........................]
 - ETA: 1s - loss: 0.1356 - acc: 0.9613


 6912/48000 [===>..........................]
 - ETA: 1s - loss: 0.1367 - acc: 0.9612


 8960/48000 [====>.........................]
 - ETA: 1s - loss: 0.1355 - acc: 0.9617


11008/48000 [=====>........................]
 - ETA: 1s - loss: 0.1431 - acc: 0.9608


13056/48000 [=======>......................]
 - ETA: 1s - loss: 0.1441 - acc: 0.9614


14976/48000 [========>.....................]
 - ETA: 0s - loss: 0.1413 - acc: 0.9623


16896/48000 [=========>....................]
 - ETA: 0s - loss: 0.1409 - acc: 0.9624


18816/48000 [==========>...................]
 - ETA: 0s - loss: 0.1408 - acc: 0.9629


20736/48000 [===========>..................]
 - ETA: 0s - loss: 0.1417 - acc: 0.9635


22784/48000 [=============>................]
 - ETA: 0s - loss: 0.1426 - acc: 0.9626


24704/48000 [==============>...............]
 - ETA: 0s - loss: 0.1419 - acc: 0.9626


26624/48000 [===============>..............]
 - ETA: 0s - loss: 0.1410 - acc: 0.9630


28672/48000 [================>.............]
 - ETA: 0s - loss: 0.1418 - acc: 0.9629


30720/48000 [==================>...........]
 - ETA: 0s - loss: 0.1422 - acc: 0.9630


32768/48000 [===================>..........]
 - ETA: 0s - loss: 0.1414 - acc: 0.9632


34560/48000 [====================>.........]
 - ETA: 0s - loss: 0.1418 - acc: 0.9634


36480/48000 [=====================>........]
 - ETA: 0s - loss: 0.1448 - acc: 0.9628


38272/48000 [======================>.......]
 - ETA: 0s - loss: 0.1446 - acc: 0.9628


40064/48000 [========================>.....]
 - ETA: 0s - loss: 0.1459 - acc: 0.9628


42112/48000 [=========================>....]
 - ETA: 0s - loss: 0.1462 - acc: 0.9626


44160/48000 [==========================>...]
 - ETA: 0s - loss: 0.1456 - acc: 0.9628


46208/48000 [===========================>..]
 - ETA: 0s - loss: 0.1446 - acc: 0.9630


48000/48000 [==============================]
 - 1s - loss: 0.1444 - acc: 0.9632 - val_loss: 0.1188 - val_acc: 0.9745


Epoch 16/20




  128/48000 [..............................]
 - ETA: 6s - loss: 0.1267 - acc: 0.9375


 1152/48000 [..............................]
 - ETA: 2s - loss: 0.1580 - acc: 0.9557


 2816/48000 [>.............................]
 - ETA: 1s - loss: 0.1373 - acc: 0.9652


 4608/48000 [=>............................]
 - ETA: 1s - loss: 0.1348 - acc: 0.9657


 6656/48000 [===>..........................]
 - ETA: 1s - loss: 0.1465 - acc: 0.9639


 8704/48000 [====>.........................]
 - ETA: 1s - loss: 0.1498 - acc: 0.9629


10752/48000 [=====>........................]
 - ETA: 1s - loss: 0.1435 - acc: 0.9637


12800/48000 [=======>......................]
 - ETA: 1s - loss: 0.1375 - acc: 0.9648


14848/48000 [========>.....................]
 - ETA: 0s - loss: 0.1362 - acc: 0.9654


16896/48000 [=========>....................]
 - ETA: 0s - loss: 0.1362 - acc: 0.9657


18944/48000 [==========>...................]
 - ETA: 0s - loss: 0.1369 - acc: 0.9656


20992/48000 [============>.................]
 - ETA: 0s - loss: 0.1404 - acc: 0.9645


22784/48000 [=============>................]
 - ETA: 0s - loss: 0.1393 - acc: 0.9651


24832/48000 [==============>...............]
 - ETA: 0s - loss: 0.1391 - acc: 0.9648


26752/48000 [===============>..............]
 - ETA: 0s - loss: 0.1388 - acc: 0.9649


28800/48000 [=================>............]
 - ETA: 0s - loss: 0.1389 - acc: 0.9648


30848/48000 [==================>...........]
 - ETA: 0s - loss: 0.1404 - acc: 0.9646


32896/48000 [===================>..........]
 - ETA: 0s - loss: 0.1395 - acc: 0.9646


34944/48000 [====================>.........]
 - ETA: 0s - loss: 0.1395 - acc: 0.9645


36992/48000 [======================>.......]
 - ETA: 0s - loss: 0.1414 - acc: 0.9643


38912/48000 [=======================>......]
 - ETA: 0s - loss: 0.1403 - acc: 0.9645


40832/48000 [========================>.....]
 - ETA: 0s - loss: 0.1416 - acc: 0.9643


42880/48000 [=========================>....]
 - ETA: 0s - loss: 0.1428 - acc: 0.9640


44928/48000 [===========================>..]
 - ETA: 0s - loss: 0.1441 - acc: 0.9640


46848/48000 [============================>.]
 - ETA: 0s - loss: 0.1451 - acc: 0.9637


48000/48000 [==============================]
 - 1s - loss: 0.1460 - acc: 0.9635 - val_loss: 0.1217 - val_acc: 0.9754


Epoch 17/20




  128/48000 [..............................]
 - ETA: 4s - loss: 0.2442 - acc: 0.9297


 1536/48000 [..............................]
 - ETA: 1s - loss: 0.1531 - acc: 0.9609


 3200/48000 [=>............................]
 - ETA: 1s - loss: 0.1443 - acc: 0.9653


 4736/48000 [=>............................]
 - ETA: 1s - loss: 0.1387 - acc: 0.9654


 6400/48000 [===>..........................]
 - ETA: 1s - loss: 0.1423 - acc: 0.9645


 8192/48000 [====>.........................]
 - ETA: 1s - loss: 0.1387 - acc: 0.9652


10240/48000 [=====>........................]
 - ETA: 1s - loss: 0.1383 - acc: 0.9650


12288/48000 [======>.......................]
 - ETA: 1s - loss: 0.1359 - acc: 0.9661


14336/48000 [=======>......................]
 - ETA: 1s - loss: 0.1358 - acc: 0.9662


16384/48000 [=========>....................]
 - ETA: 0s - loss: 0.1394 - acc: 0.9656


18304/48000 [==========>...................]
 - ETA: 0s - loss: 0.1373 - acc: 0.9655


20352/48000 [===========>..................]
 - ETA: 0s - loss: 0.1382 - acc: 0.9657


22400/48000 [=============>................]
 - ETA: 0s - loss: 0.1404 - acc: 0.9653


24320/48000 [==============>...............]
 - ETA: 0s - loss: 0.1441 - acc: 0.9651


26368/48000 [===============>..............]
 - ETA: 0s - loss: 0.1457 - acc: 0.9642


28416/48000 [================>.............]
 - ETA: 0s - loss: 0.1453 - acc: 0.9645


30464/48000 [==================>...........]
 - ETA: 0s - loss: 0.1474 - acc: 0.9639


32512/48000 [===================>..........]
 - ETA: 0s - loss: 0.1476 - acc: 0.9641


34432/48000 [====================>.........]
 - ETA: 0s - loss: 0.1473 - acc: 0.9643


36352/48000 [=====================>........]
 - ETA: 0s - loss: 0.1474 - acc: 0.9647


38144/48000 [======================>.......]
 - ETA: 0s - loss: 0.1475 - acc: 0.9644


39936/48000 [=======================>......]
 - ETA: 0s - loss: 0.1479 - acc: 0.9641


41984/48000 [=========================>....]
 - ETA: 0s - loss: 0.1468 - acc: 0.9644


44032/48000 [==========================>...]
 - ETA: 0s - loss: 0.1472 - acc: 0.9643


45952/48000 [===========================>..]
 - ETA: 0s - loss: 0.1469 - acc: 0.9642


48000/48000 [==============================]
 - 1s - loss: 0.1462 - acc: 0.9642 - val_loss: 0.1187 - val_acc: 0.9749


Epoch 18/20




  128/48000 [..............................]
 - ETA: 2s - loss: 0.2785 - acc: 0.9531


 1408/48000 [..............................]
 - ETA: 1s - loss: 0.1099 - acc: 0.9766


 2944/48000 [>.............................]
 - ETA: 1s - loss: 0.1135 - acc: 0.9728


 4736/48000 [=>............................]
 - ETA: 1s - loss: 0.1369 - acc: 0.9707


 6656/48000 [===>..........................]
 - ETA: 1s - loss: 0.1438 - acc: 0.9691


 8576/48000 [====>.........................]
 - ETA: 1s - loss: 0.1505 - acc: 0.9660


10496/48000 [=====>........................]
 - ETA: 1s - loss: 0.1405 - acc: 0.9671


12416/48000 [======>.......................]
 - ETA: 1s - loss: 0.1424 - acc: 0.9664


14464/48000 [========>.....................]
 - ETA: 0s - loss: 0.1450 - acc: 0.9645


16256/48000 [=========>....................]
 - ETA: 0s - loss: 0.1433 - acc: 0.9649


18176/48000 [==========>...................]
 - ETA: 0s - loss: 0.1423 - acc: 0.9647


20096/48000 [===========>..................]
 - ETA: 0s - loss: 0.1415 - acc: 0.9647


22144/48000 [============>.................]
 - ETA: 0s - loss: 0.1411 - acc: 0.9643


24064/48000 [==============>...............]
 - ETA: 0s - loss: 0.1420 - acc: 0.9645


25984/48000 [===============>..............]
 - ETA: 0s - loss: 0.1415 - acc: 0.9645


28032/48000 [================>.............]
 - ETA: 0s - loss: 0.1438 - acc: 0.9644


30080/48000 [=================>............]
 - ETA: 0s - loss: 0.1443 - acc: 0.9644


32128/48000 [===================>..........]
 - ETA: 0s - loss: 0.1450 - acc: 0.9642


34048/48000 [====================>.........]
 - ETA: 0s - loss: 0.1471 - acc: 0.9643


35968/48000 [=====================>........]
 - ETA: 0s - loss: 0.1473 - acc: 0.9642


38016/48000 [======================>.......]
 - ETA: 0s - loss: 0.1467 - acc: 0.9644


40064/48000 [========================>.....]
 - ETA: 0s - loss: 0.1473 - acc: 0.9643


42112/48000 [=========================>....]
 - ETA: 0s - loss: 0.1481 - acc: 0.9641


44160/48000 [==========================>...]
 - ETA: 0s - loss: 0.1481 - acc: 0.9639


46080/48000 [===========================>..]
 - ETA: 0s - loss: 0.1474 - acc: 0.9640


48000/48000 [==============================]
 - 1s - loss: 0.1466 - acc: 0.9642 - val_loss: 0.1191 - val_acc: 0.9756


Epoch 19/20




  128/48000 [..............................]
 - ETA: 3s - loss: 0.0998 - acc: 0.9688


 1408/48000 [..............................]
 - ETA: 1s - loss: 0.1324 - acc: 0.9673


 3328/48000 [=>............................]
 - ETA: 1s - loss: 0.1429 - acc: 0.9642


 5248/48000 [==>...........................]
 - ETA: 1s - loss: 0.1478 - acc: 0.9628


 7168/48000 [===>..........................]
 - ETA: 1s - loss: 0.1490 - acc: 0.9629


 9088/48000 [====>.........................]
 - ETA: 1s - loss: 0.1467 - acc: 0.9631


11136/48000 [=====>........................]
 - ETA: 1s - loss: 0.1431 - acc: 0.9635


13184/48000 [=======>......................]
 - ETA: 0s - loss: 0.1389 - acc: 0.9645


15104/48000 [========>.....................]
 - ETA: 0s - loss: 0.1428 - acc: 0.9640


17024/48000 [=========>....................]
 - ETA: 0s - loss: 0.1471 - acc: 0.9626


19072/48000 [==========>...................]
 - ETA: 0s - loss: 0.1468 - acc: 0.9625


20992/48000 [============>.................]
 - ETA: 0s - loss: 0.1454 - acc: 0.9628


23040/48000 [=============>................]
 - ETA: 0s - loss: 0.1447 - acc: 0.9628


24960/48000 [==============>...............]
 - ETA: 0s - loss: 0.1469 - acc: 0.9626


27008/48000 [===============>..............]
 - ETA: 0s - loss: 0.1474 - acc: 0.9628


28928/48000 [=================>............]
 - ETA: 0s - loss: 0.1457 - acc: 0.9635


30848/48000 [==================>...........]
 - ETA: 0s - loss: 0.1459 - acc: 0.9635


32896/48000 [===================>..........]
 - ETA: 0s - loss: 0.1481 - acc: 0.9633


34816/48000 [====================>.........]
 - ETA: 0s - loss: 0.1476 - acc: 0.9635


36736/48000 [=====================>........]
 - ETA: 0s - loss: 0.1484 - acc: 0.9630


38528/48000 [=======================>......]
 - ETA: 0s - loss: 0.1473 - acc: 0.9630


40320/48000 [========================>.....]
 - ETA: 0s - loss: 0.1472 - acc: 0.9631


42368/48000 [=========================>....]
 - ETA: 0s - loss: 0.1480 - acc: 0.9631


44416/48000 [==========================>...]
 - ETA: 0s - loss: 0.1486 - acc: 0.9627


46464/48000 [============================>.]
 - ETA: 0s - loss: 0.1484 - acc: 0.9625


48000/48000 [==============================]
 - 1s - loss: 0.1478 - acc: 0.9626 - val_loss: 0.1244 - val_acc: 0.9750


Epoch 20/20




  128/48000 [..............................]
 - ETA: 7s - loss: 0.0470 - acc: 0.9844


 1152/48000 [..............................]
 - ETA: 2s - loss: 0.1663 - acc: 0.9583


 2944/48000 [>.............................]
 - ETA: 1s - loss: 0.1597 - acc: 0.9643


 4736/48000 [=>............................]
 - ETA: 1s - loss: 0.1537 - acc: 0.9633


 6784/48000 [===>..........................]
 - ETA: 1s - loss: 0.1609 - acc: 0.9611


 8832/48000 [====>.........................]
 - ETA: 1s - loss: 0.1490 - acc: 0.9633


10752/48000 [=====>........................]
 - ETA: 1s - loss: 0.1478 - acc: 0.9637


12800/48000 [=======>......................]
 - ETA: 1s - loss: 0.1433 - acc: 0.9638


14720/48000 [========>.....................]
 - ETA: 0s - loss: 0.1410 - acc: 0.9648


16640/48000 [=========>....................]
 - ETA: 0s - loss: 0.1421 - acc: 0.9649


18560/48000 [==========>...................]
 - ETA: 0s - loss: 0.1426 - acc: 0.9651


20224/48000 [===========>..................]
 - ETA: 0s - loss: 0.1414 - acc: 0.9655


21888/48000 [============>.................]
 - ETA: 0s - loss: 0.1417 - acc: 0.9654


23552/48000 [=============>................]
 - ETA: 0s - loss: 0.1412 - acc: 0.9654


25600/48000 [===============>..............]
 - ETA: 0s - loss: 0.1407 - acc: 0.9655


27520/48000 [================>.............]
 - ETA: 0s - loss: 0.1403 - acc: 0.9653


29568/48000 [=================>............]
 - ETA: 0s - loss: 0.1411 - acc: 0.9654


31616/48000 [==================>...........]
 - ETA: 0s - loss: 0.1402 - acc: 0.9655


33664/48000 [====================>.........]
 - ETA: 0s - loss: 0.1415 - acc: 0.9654


35712/48000 [=====================>........]
 - ETA: 0s - loss: 0.1413 - acc: 0.9653


37760/48000 [======================>.......]
 - ETA: 0s - loss: 0.1434 - acc: 0.9649


39808/48000 [=======================>......]
 - ETA: 0s - loss: 0.1435 - acc: 0.9653


41856/48000 [=========================>....]
 - ETA: 0s - loss: 0.1423 - acc: 0.9653


43904/48000 [==========================>...]
 - ETA: 0s - loss: 0.1427 - acc: 0.9655


45952/48000 [===========================>..]
 - ETA: 0s - loss: 0.1422 - acc: 0.9655


48000/48000 [==============================]
 - 1s - loss: 0.1434 - acc: 0.9653 - val_loss: 0.1469 - val_acc: 0.9728



> plot(history)

> score <- model %>% evaluate(
+   x_test, y_test,
+   verbose = 0
+ )

> cat('Test loss:', score$loss, '\n')
Test loss: 0.1403067 

> cat('Test accuracy:', score$acc, '\n')
Test accuracy: 0.9732 
