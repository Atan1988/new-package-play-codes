<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0077)https://www.r-bloggers.com/comparing-smooths-in-factor-smooth-interactions-i/ -->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" prefix="og: http://ogp.me/ns#" itemscope="" itemtype="http://schema.org/WebSite"><head profile="http://gmpg.org/xfn/11"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>Comparing smooths in factor-smooth interactions I | R-bloggers</title>

<script async="" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/async-ads.js.download"></script><script src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/cb=gapi.loaded_0" async=""></script><script type="text/javascript" async="" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/cse.js.download"></script><script async="" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/analytics.js.download"></script><script type="text/javascript" async="" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/vglnk.js.download"></script><script async="" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/analytics.js.download"></script><script src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/pAx-dKbLyle7umPnDyx7D0pQbKA.js.download"></script><script src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/XwzxUUnPwVYUc-cNUnfA25jqByU.js.download"></script><link rel="stylesheet" href="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/style.css" type="text/css" media="screen">

<style type="text/css">

body { width: 1024px; }

#mainwrapper { width: 1004px; }

#sidebar { width: 180px; }

#sidebar .side-widget { width: 160px; }


#secondsidebar { width: 300px; }

#secondsidebar .side-widget { width: 300px; }


#leftcontent, #twocol, #threecol, #threecol2, .commentlist { width: 456px; }

#leftcontent img, .wp-caption { max-width: 456px; }

#leftcontent .wp-caption img, #leftcontent .gallery-thumb img { max-width: 444px; }

<!-- fix for IE & Safari -->

.threepost embed { width: 132.24px !important; }

.twopost embed { width: 209.76px !important; }

<!-- end fix for Safari -->

</style>

	<link rel="pingback" href="https://www.r-bloggers.com/xmlrpc.php">
<!--[if IE]>
<link rel="stylesheet" type="text/css" href="https://www.r-bloggers.com/wp-content/themes/magazine-basic/iestyles.css" />
<![endif]-->

<!-- Open Graph Meta Tags generated by MashShare 3.4.4 - https://mashshare.net -->
<meta property="og:type" content="article"> 
<meta property="og:title" content="Comparing smooths in factor-smooth interactions I">
<meta property="og:description" content="One of the really appealing features of the mgcv package for fitting GAMs is the functionality it exposes for fitting quite complex models, models that lie well beyond what many of us may have learned about what GAMs can do. One of those features that I use a lot is the ability to model the smooth effects of some covariate (x) in the different levels of a factor. Having estimated a separate smoother for each level of the factor, the obvious question is, which smooths are different? In this post I’ll take a look at one way to do this using by-variable smooths.">
<meta property="og:url" content="https://www.r-bloggers.com/comparing-smooths-in-factor-smooth-interactions-i/">
<meta property="og:site_name" content="R-bloggers">
<meta property="article:publisher" content="https://www.facebook.com/rbloggers/">
<meta property="article:published_time" content="2017-10-10T16:00:00+00:00">
<meta property="article:modified_time" content="2017-10-10T16:00:00+00:00">
<meta property="og:updated_time" content="2017-10-10T16:00:00+00:00">
<!-- Open Graph Meta Tags generated by MashShare 3.4.4 - https://www.mashshare.net -->
<!-- Twitter Card generated by MashShare 3.4.4 - https://www.mashshare.net -->
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Comparing smooths in factor-smooth interactions I">
<meta name="twitter:description" content="One of the really appealing features of the mgcv package for fitting GAMs is the functionality it exposes for fitting quite complex models, models that lie well beyond what many of us may have learned about what GAMs can do. One of those features that I use a lot is the ability to model the smooth effects of some covariate (x) in the different levels of a factor. Having estimated a separate smoother for each level of the factor, the obvious question is, which smooths are different? In this post I’ll take a look at one way to do this using by-variable smooths.">
<meta name="twitter:site" content="@Rbloggers">
<!-- Twitter Card generated by MashShare 3.4.4 - https://www.mashshare.net -->


<!-- All in One SEO Pack 2.3.16 by Michael Torbert of Semper Fi Web Design[372,443] -->
<meta name="description" content="One of the really appealing features of the mgcv package for fitting GAMs is the functionality it exposes for fitting quite complex models, models that lie well">

<link rel="canonical" href="https://www.r-bloggers.com/comparing-smooths-in-factor-smooth-interactions-i/">
<!-- /all in one seo pack -->
<link rel="dns-prefetch" href="https://s0.wp.com/">
<link rel="dns-prefetch" href="https://s.w.org/">
<!-- This site uses the Google Analytics by MonsterInsights plugin v6.2.2 - Using Analytics tracking - https://www.monsterinsights.com/ -->
<script type="text/javascript" data-cfasync="false">
		var disableStr = 'ga-disable-UA-419807-53';

	/* Function to detect opted out users */
	function __gaTrackerIsOptedOut() {
		return document.cookie.indexOf(disableStr + '=true') > -1;
	}

	/* Disable tracking if the opt-out cookie exists. */
	if ( __gaTrackerIsOptedOut() ) {
		window[disableStr] = true;
	}

	/* Opt-out function */
	function __gaTrackerOptout() {
	  document.cookie = disableStr + '=true; expires=Thu, 31 Dec 2099 23:59:59 UTC; path=/';
	  window[disableStr] = true;
	}
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','__gaTracker');

	__gaTracker('create', 'UA-419807-53', 'auto');
	__gaTracker('set', 'forceSSL', true);
	__gaTracker('send','pageview');
</script>
<!-- / Google Analytics by MonsterInsights -->
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/www.r-bloggers.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.6.1"}};
			!function(a,b,c){function d(a){var c,d,e,f,g,h=b.createElement("canvas"),i=h.getContext&&h.getContext("2d"),j=String.fromCharCode;if(!i||!i.fillText)return!1;switch(i.textBaseline="top",i.font="600 32px Arial",a){case"flag":return i.fillText(j(55356,56806,55356,56826),0,0),!(h.toDataURL().length<3e3)&&(i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,65039,8205,55356,57096),0,0),c=h.toDataURL(),i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,55356,57096),0,0),d=h.toDataURL(),c!==d);case"diversity":return i.fillText(j(55356,57221),0,0),e=i.getImageData(16,16,1,1).data,f=e[0]+","+e[1]+","+e[2]+","+e[3],i.fillText(j(55356,57221,55356,57343),0,0),e=i.getImageData(16,16,1,1).data,g=e[0]+","+e[1]+","+e[2]+","+e[3],f!==g;case"simple":return i.fillText(j(55357,56835),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode8":return i.fillText(j(55356,57135),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode9":return i.fillText(j(55358,56631),0,0),0!==i.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity","unicode9"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/wp-emoji-release.min.js.download" type="text/javascript"></script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel="stylesheet" id="wgs2-css" href="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/wgs2.css" type="text/css" media="all">
<link rel="stylesheet" id="snp_styles_reset-css" href="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/reset.min.css" type="text/css" media="all">
<link rel="stylesheet" id="fancybox2-css" href="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/jquery.fancybox.min.css" type="text/css" media="all">
<link rel="stylesheet" id="snp_styles_theme6-css" href="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/theme6.css" type="text/css" media="all">
<link rel="stylesheet" id="mashsb-styles-css" href="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/mashsb.min.css" type="text/css" media="all">
<style id="mashsb-styles-inline-css" type="text/css">
.mashsb-count {color:#cccccc;}@media only screen and (min-width:568px){.mashsb-buttons a {min-width: 177px;}}
</style>
<link rel="stylesheet" id="wpt-twitter-feed-css" href="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/twitter-feed.css" type="text/css" media="all">
<link rel="stylesheet" id="jetpack_css-css" href="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/jetpack.css" type="text/css" media="all">
<link rel="stylesheet" id="codebox-css" href="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/codebox.css" type="text/css" media="screen">
<script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/jquery.min.js.download"></script>
<script type="text/javascript">try{jQuery.noConflict();}catch(e){};</script>
<script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/jquery-migrate.min.js.download"></script>
<script type="text/javascript">
/* <![CDATA[ */
var related_posts_js_options = {"post_heading":"h4"};
/* ]]> */
</script>
<script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/related-posts.js.download"></script>
<script type="text/javascript">
/* <![CDATA[ */
var monsterinsights_frontend = {"js_events_tracking":"true","is_debug_mode":"false","download_extensions":"doc,exe,js,pdf,ppt,tgz,zip,xls","inbound_paths":"","home_url":"https:\/\/www.r-bloggers.com","track_download_as":"event","internal_label":"int","hash_tracking":"false"};
/* ]]> */
</script>
<script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/frontend.min.js.download"></script>
<script type="text/javascript">
/* <![CDATA[ */
var mashsb = {"shares":"0","round_shares":"1","animate_shares":"0","dynamic_buttons":"0","share_url":"https:\/\/www.r-bloggers.com\/comparing-smooths-in-factor-smooth-interactions-i\/","title":"Comparing+smooths+in+factor-smooth+interactions+I","image":null,"desc":"\nOne of the really appealing features of the mgcv package for fitting GAMs is the functionality it exposes for fitting quite complex models, models that lie well beyond what many of us may have learned about what GAMs can do. One of those features that I use a lot is the ability to model the smooth effects of some covariate (x) in the different levels of a factor. Having estimated a separate smoother for each level of the factor, the obvious question is, which smooths are different? In this post I\u2019ll take a look at one way to do this using by-variable smooths.\n","hashtag":"Rbloggers","subscribe":"link","subscribe_url":"https:\/\/feedburner.google.com\/fb\/a\/mailverify?uri=RBloggers","activestatus":"1","singular":"1","twitter_popup":"1","refresh":"0"};
/* ]]> */
</script>
<script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/mashsb.min.js.download"></script>
<script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/codebox.js.download"></script>
<link rel="https://api.w.org/" href="https://www.r-bloggers.com/wp-json/">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.r-bloggers.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.r-bloggers.com/wp-includes/wlwmanifest.xml"> 
<link rel="prev" title="R’s remarkable growth" href="https://www.r-bloggers.com/rs-remarkable-growth/">
<meta name="generator" content="WordPress 4.6.1">
<link rel="shortlink" href="https://wp.me/pMm6L-Eyp">
<link rel="alternate" type="application/json+oembed" href="https://www.r-bloggers.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.r-bloggers.com%2Fcomparing-smooths-in-factor-smooth-interactions-i%2F">
<link rel="alternate" type="text/xml+oembed" href="https://www.r-bloggers.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.r-bloggers.com%2Fcomparing-smooths-in-factor-smooth-interactions-i%2F&amp;format=xml">
<!-- This site is powered by Tweet, Like, Plusone and Share Plugin - http://techxt.com/tweet-like-google-1-and-share-plugin-wordpress/ -->
<style type="text/css">div.socialicons{float:left;display:block;margin-right: 10px;line-height: 1;}div.socialiconsv{line-height: 1;}div.socialicons p{margin-bottom: 0px !important;margin-top: 0px !important;padding-bottom: 0px !important;padding-top: 0px !important;}div.social4iv{background: none repeat scroll 0 0 #FFFFFF;border: 1px solid #aaa;border-radius: 3px 3px 3px 3px;box-shadow: 3px 3px 3px #DDDDDD;padding: 3px;position: fixed;text-align: center;top: 55px;width: 68px;display:none;}div.socialiconsv{padding-bottom: 5px;}</style>

<link rel="dns-prefetch" href="https://i0.wp.com/">
<link rel="dns-prefetch" href="https://i1.wp.com/">
<link rel="dns-prefetch" href="https://i2.wp.com/">
<style type="text/css">img#wpstats{display:none}</style><link rel="amphtml" href="https://www.r-bloggers.com/comparing-smooths-in-factor-smooth-interactions-i/amp/"><link rel="stylesheet" type="text/css" href="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/shCore.css"><link rel="stylesheet" type="text/css" href="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/shThemeDefault.css"><style type="text/css" id="syntaxhighlighteranchor"></style>

<!-- WordPress Facebook Open Graph protocol plugin (WPFBOGP v2.0.13) http://rynoweb.com/wordpress-plugins/ -->
<meta property="fb:app_id" content="143207055763488">
<meta property="og:image" content="https://www.r-bloggers.com/wp-content/uploads/2016/08/R_single_01-200-1.png">
<meta property="og:image" content="http://www.fromthebottomoftheheap.net/assets/img/posts/difference-smooths-i-plot-difference-smmoths-1.png">
<meta property="og:image" content="http://www.fromthebottomoftheheap.net/assets/img/posts/difference-smooths-i-plot-smooths-1.png">
<meta property="og:image" content="http://www.fromthebottomoftheheap.net/assets/img/posts/difference-smooths-i-plot-data-1.png">
<!-- // end wpfbogp -->
<link rel="icon" href="https://i2.wp.com/www.r-bloggers.com/wp-content/uploads/2016/08/cropped-R_single_01-200.png?fit=32%2C32&amp;ssl=1" sizes="32x32">
<link rel="icon" href="https://i2.wp.com/www.r-bloggers.com/wp-content/uploads/2016/08/cropped-R_single_01-200.png?fit=192%2C192&amp;ssl=1" sizes="192x192">
<link rel="apple-touch-icon-precomposed" href="https://i2.wp.com/www.r-bloggers.com/wp-content/uploads/2016/08/cropped-R_single_01-200.png?fit=180%2C180&amp;ssl=1">
<meta name="msapplication-TileImage" content="https://i2.wp.com/www.r-bloggers.com/wp-content/uploads/2016/08/cropped-R_single_01-200.png?fit=270%2C270&amp;ssl=1">
<script src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/secureAnonymousFramework"></script><style type="text/css">.fb_hidden{position:absolute;top:-10000px;z-index:10001}.fb_reposition{overflow:hidden;position:relative}.fb_invisible{display:none}.fb_reset{background:none;border:0;border-spacing:0;color:#000;cursor:auto;direction:ltr;font-family:"lucida grande", tahoma, verdana, arial, sans-serif;font-size:11px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:1;margin:0;overflow:visible;padding:0;text-align:left;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;visibility:visible;white-space:normal;word-spacing:normal}.fb_reset>div{overflow:hidden}.fb_link img{border:none}@keyframes fb_transform{from{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}.fb_animate{animation:fb_transform .3s forwards}.fb_shrink_active{opacity:1;transform:scale(1, 1);transition-duration:200ms;transition-timing-function:ease-out}.fb_shrink_active:active{opacity:.5;transform:scale(.75, .75)}
.fb_dialog{background:rgba(82, 82, 82, .7);position:absolute;top:-10000px;z-index:10001}.fb_reset .fb_dialog_legacy{overflow:visible}.fb_dialog_advanced{padding:10px;-moz-border-radius:8px;-webkit-border-radius:8px;border-radius:8px}.fb_dialog_content{background:#fff;color:#333}.fb_dialog_close_icon{background:url(http://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 0 transparent;cursor:pointer;display:block;height:15px;position:absolute;right:18px;top:17px;width:15px}.fb_dialog_mobile .fb_dialog_close_icon{top:5px;left:5px;right:auto}.fb_dialog_padding{background-color:transparent;position:absolute;width:1px;z-index:-1}.fb_dialog_close_icon:hover{background:url(http://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -15px transparent}.fb_dialog_close_icon:active{background:url(http://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -30px transparent}.fb_dialog_loader{background-color:#f6f7f9;border:1px solid #606060;font-size:24px;padding:20px}.fb_dialog_top_left,.fb_dialog_top_right,.fb_dialog_bottom_left,.fb_dialog_bottom_right{height:10px;width:10px;overflow:hidden;position:absolute}.fb_dialog_top_left{background:url(http://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 0;left:-10px;top:-10px}.fb_dialog_top_right{background:url(http://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -10px;right:-10px;top:-10px}.fb_dialog_bottom_left{background:url(http://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -20px;bottom:-10px;left:-10px}.fb_dialog_bottom_right{background:url(http://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -30px;right:-10px;bottom:-10px}.fb_dialog_vert_left,.fb_dialog_vert_right,.fb_dialog_horiz_top,.fb_dialog_horiz_bottom{position:absolute;background:#525252;filter:alpha(opacity=70);opacity:.7}.fb_dialog_vert_left,.fb_dialog_vert_right{width:10px;height:100%}.fb_dialog_vert_left{margin-left:-10px}.fb_dialog_vert_right{right:0;margin-right:-10px}.fb_dialog_horiz_top,.fb_dialog_horiz_bottom{width:100%;height:10px}.fb_dialog_horiz_top{margin-top:-10px}.fb_dialog_horiz_bottom{bottom:0;margin-bottom:-10px}.fb_dialog_iframe{line-height:0}.fb_dialog_content .dialog_title{background:#6d84b4;border:1px solid #365899;color:#fff;font-size:14px;font-weight:bold;margin:0}.fb_dialog_content .dialog_title>span{background:url(http://static.xx.fbcdn.net/rsrc.php/v3/yd/r/Cou7n-nqK52.gif) no-repeat 5px 50%;float:left;padding:5px 0 7px 26px}body.fb_hidden{-webkit-transform:none;height:100%;margin:0;overflow:visible;position:absolute;top:-10000px;left:0;width:100%}.fb_dialog.fb_dialog_mobile.loading{background:url(http://static.xx.fbcdn.net/rsrc.php/v3/ya/r/3rhSv5V8j3o.gif) white no-repeat 50% 50%;min-height:100%;min-width:100%;overflow:hidden;position:absolute;top:0;z-index:10001}.fb_dialog.fb_dialog_mobile.loading.centered{width:auto;height:auto;min-height:initial;min-width:initial;background:none}.fb_dialog.fb_dialog_mobile.loading.centered #fb_dialog_loader_spinner{width:100%}.fb_dialog.fb_dialog_mobile.loading.centered .fb_dialog_content{background:none}.loading.centered #fb_dialog_loader_close{color:#fff;display:block;padding-top:20px;clear:both;font-size:18px}#fb-root #fb_dialog_ipad_overlay{background:rgba(0, 0, 0, .45);position:absolute;bottom:0;left:0;right:0;top:0;width:100%;min-height:100%;z-index:10000}#fb-root #fb_dialog_ipad_overlay.hidden{display:none}.fb_dialog.fb_dialog_mobile.loading iframe{visibility:hidden}.fb_dialog_content .dialog_header{-webkit-box-shadow:white 0 1px 1px -1px inset;background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#738ABA), to(#2C4987));border-bottom:1px solid;border-color:#1d4088;color:#fff;font:14px Helvetica, sans-serif;font-weight:bold;text-overflow:ellipsis;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0;vertical-align:middle;white-space:nowrap}.fb_dialog_content .dialog_header table{-webkit-font-smoothing:subpixel-antialiased;height:43px;width:100%}.fb_dialog_content .dialog_header td.header_left{font-size:12px;padding-left:5px;vertical-align:middle;width:60px}.fb_dialog_content .dialog_header td.header_right{font-size:12px;padding-right:5px;vertical-align:middle;width:60px}.fb_dialog_content .touchable_button{background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#4966A6), color-stop(.5, #355492), to(#2A4887));border:1px solid #29487d;-webkit-background-clip:padding-box;-webkit-border-radius:3px;-webkit-box-shadow:rgba(0, 0, 0, .117188) 0 1px 1px inset, rgba(255, 255, 255, .167969) 0 1px 0;display:inline-block;margin-top:3px;max-width:85px;line-height:18px;padding:4px 12px;position:relative}.fb_dialog_content .dialog_header .touchable_button input{border:none;background:none;color:#fff;font:12px Helvetica, sans-serif;font-weight:bold;margin:2px -12px;padding:2px 6px 3px 6px;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog_content .dialog_header .header_center{color:#fff;font-size:16px;font-weight:bold;line-height:18px;text-align:center;vertical-align:middle}.fb_dialog_content .dialog_content{background:url(http://static.xx.fbcdn.net/rsrc.php/v3/y9/r/jKEcVPZFk-2.gif) no-repeat 50% 50%;border:1px solid #555;border-bottom:0;border-top:0;height:150px}.fb_dialog_content .dialog_footer{background:#f6f7f9;border:1px solid #555;border-top-color:#ccc;height:40px}#fb_dialog_loader_close{float:left}.fb_dialog.fb_dialog_mobile .fb_dialog_close_button{text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog.fb_dialog_mobile .fb_dialog_close_icon{visibility:hidden}#fb_dialog_loader_spinner{animation:rotateSpinner 1.2s linear infinite;background-color:transparent;background-image:url(http://static.xx.fbcdn.net/rsrc.php/v3/yD/r/t-wz8gw1xG1.png);background-repeat:no-repeat;background-position:50% 50%;height:24px;width:24px}@keyframes rotateSpinner{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
.fb_iframe_widget{display:inline-block;position:relative}.fb_iframe_widget span{display:inline-block;position:relative;text-align:justify}.fb_iframe_widget iframe{position:absolute}.fb_iframe_widget_fluid_desktop,.fb_iframe_widget_fluid_desktop span,.fb_iframe_widget_fluid_desktop iframe{max-width:100%}.fb_iframe_widget_fluid_desktop iframe{min-width:220px;position:relative}.fb_iframe_widget_lift{z-index:1}.fb_hide_iframes iframe{position:relative;left:-10000px}.fb_iframe_widget_loader{position:relative;display:inline-block}.fb_iframe_widget_fluid{display:inline}.fb_iframe_widget_fluid span{width:100%}.fb_iframe_widget_loader iframe{min-height:32px;z-index:2;zoom:1}.fb_iframe_widget_loader .FB_Loader{background:url(http://static.xx.fbcdn.net/rsrc.php/v3/y9/r/jKEcVPZFk-2.gif) no-repeat;height:32px;width:32px;margin-left:-16px;position:absolute;left:50%;z-index:4}</style><script type="text/x-mathjax-config;executed=true">MathJax.Hub.Config({
                    jax: ["input/TeX","input/MathML","input/AsciiMath","output/CommonHTML"],
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
});

// Renders math images using MathJax instead
// which makes text selectable
MathJax.Extension.myImg2jax = {
  version: "1.0",

  PreProcess: function (element) {
    var images = element.getElementsByTagName("img");
    for (var i = images.length - 1; i >= 0; i--) {
    var img = images[i];
    if (img.className === "mwe-math-fallback-image-inline") {
        var script = document.createElement("script");
        script.type = "math/tex";
        MathJax.HTML.setScript(script, img.alt);
        img.parentNode.replaceChild(script, img);
      }
    }
  }
};

MathJax.Hub.Register.PreProcessor(["PreProcess", MathJax.Extension.myImg2jax]);</script><script src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/MathJax.js.download" id=""></script><script src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/jsapi" type="text/javascript"></script><style type="text/css">* html #li_ui_li_gen_1507763867623_0 a#li_ui_li_gen_1507763867623_0-link{height:1% !important;}#li_ui_li_gen_1507763867623_0{position:relative !important;overflow:visible !important;display:block !important;}#li_ui_li_gen_1507763867623_0 span{-webkit-box-sizing:content-box !important;-moz-box-sizing:content-box !important;box-sizing:content-box !important;}#li_ui_li_gen_1507763867623_0 a#li_ui_li_gen_1507763867623_0-link{border:0 !important;height:20px !important;text-decoration:none !important;padding:0 !important;margin:0 !important;display:inline-block !important;}#li_ui_li_gen_1507763867623_0 a#li_ui_li_gen_1507763867623_0-link:link, #li_ui_li_gen_1507763867623_0 a#li_ui_li_gen_1507763867623_0-link:visited, #li_ui_li_gen_1507763867623_0 a#li_ui_li_gen_1507763867623_0-link:hover, #li_ui_li_gen_1507763867623_0 a#li_ui_li_gen_1507763867623_0-link:active{border:0 !important;text-decoration:none !important;}#li_ui_li_gen_1507763867623_0 a#li_ui_li_gen_1507763867623_0-link:after{content:"." !important;display:block !important;clear:both !important;visibility:hidden !important;line-height:0 !important;height:0 !important;}#li_ui_li_gen_1507763867623_0 #li_ui_li_gen_1507763867623_0-logo{background-image:url(https://static.licdn.com/scds/common/u/images/apps/connect/sprites/sprite_connect_v14.png) !important;background-position:-56px -423px !important;background-repeat:no-repeat !important;background-color:#0077b5 !important;background-size:135px auto !important;cursor:pointer !important;border:0 !important;border-right:1px solid #066094 !important;text-indent:-9999em !important;overflow:hidden !important;padding:0 !important;margin:0 !important;position:absolute !important;left:0px !important;top:0px !important;display:block !important;width:20px !important;height:20px !important;float:right !important;border-radius:2px !important;-webkit-border-radius:2px !important;border-top-right-radius:2px !important;border-bottom-right-radius:2px !important;-webkit-border-top-right-radius:2px !important;-webkit-border-bottom-right-radius:2px !important;}#li_ui_li_gen_1507763867623_0 #li_ui_li_gen_1507763867623_0-title{color:#fff !important;cursor:pointer !important;display:block !important;white-space:nowrap !important;float:left !important;margin-left:1px !important;vertical-align:top !important;overflow:hidden !important;text-align:center !important;height:18px !important;padding:0 4px 0 23px !important;border:1px solid #000 !important;border-top-color:#0077b5 !important;border-right-color:#0077b5 !important;border-bottom-color:#0077b5 !important;border-left-color:#0077b5 !important;text-shadow:0 -1px #005887 !important;line-height:20px !important;border-radius:2px !important;-webkit-border-radius:2px !important;border-top-right-radius:2px !important;border-bottom-right-radius:2px !important;-webkit-border-top-right-radius:2px !important;-webkit-border-bottom-right-radius:2px !important;background-color:#0077b5 !important;background-image:-webkit-gradient(linear, left top, left bottom, color-stop(0%,#0077b5), color-stop(100%,#0077b5)) !important; background-image: -webkit-linear-gradient(top, #0077b5 0%, #0077b5 100%) !important;}#li_ui_li_gen_1507763867623_0.hovered #li_ui_li_gen_1507763867623_0-title{border:1px solid #000 !important;border-top-color:#0369a0 !important;border-right-color:#0369a0 !important;border-bottom-color:#0369a0 !important;border-left-color:#0369a0 !important;background-color:#0369a0 !important;background-image:-webkit-gradient(linear, left top, left bottom, color-stop(0%,#0369a0), color-stop(100%,#0369a0)) !important; background-image: -webkit-linear-gradient(top, #0369a0 0%, #0369a0 100%) !important;}#li_ui_li_gen_1507763867623_0.clicked #li_ui_li_gen_1507763867623_0-title, #li_ui_li_gen_1507763867623_0.down #li_ui_li_gen_1507763867623_0-title{color:#fff !important;border:1px solid #000 !important;border-top-color:#066094 !important;border-right-color:#066094 !important;border-bottom-color:#066094 !important;border-left-color:#066094 !important;background-color:#066094 !important;background-image:-webkit-gradient(linear, left top, left bottom, color-stop(0%,#066094), color-stop(100%,#066094)) !important; background-image: -webkit-linear-gradient(top, #066094 0%, #066094 100%) !important;}.IN-shadowed #li_ui_li_gen_1507763867623_0 #li_ui_li_gen_1507763867623_0-title{}.IN-shadowed #li_ui_li_gen_1507763867623_0.hovered #li_ui_li_gen_1507763867623_0-title{}.IN-shadowed #li_ui_li_gen_1507763867623_0.clicked #li_ui_li_gen_1507763867623_0-title, .IN-shadowed #li_ui_li_gen_1507763867623_0.down #li_ui_li_gen_1507763867623_0-title{}#li_ui_li_gen_1507763867623_0 #li_ui_li_gen_1507763867623_0-title-text, #li_ui_li_gen_1507763867623_0 #li_ui_li_gen_1507763867623_0-title-text *{color:#fff !important;font-size:11px !important;font-family:Arial, sans-serif !important;font-weight:bold !important;font-style:normal !important;-webkit-font-smoothing:antialiased !important;display:inline-block !important;background:transparent none !important;vertical-align:top !important;height:18px !important;line-height:20px !important;float:none !important;}#li_ui_li_gen_1507763867623_0 #li_ui_li_gen_1507763867623_0-title-text strong{font-weight:bold !important;}#li_ui_li_gen_1507763867623_0 #li_ui_li_gen_1507763867623_0-title-text em{font-style:italic !important;}#li_ui_li_gen_1507763867623_0.hovered #li_ui_li_gen_1507763867623_0-title-text, #li_ui_li_gen_1507763867623_0.hovered #li_ui_li_gen_1507763867623_0-title-text *{color:#fff !important;}#li_ui_li_gen_1507763867623_0.clicked #li_ui_li_gen_1507763867623_0-title-text, #li_ui_li_gen_1507763867623_0.down #li_ui_li_gen_1507763867623_0-title-text, #li_ui_li_gen_1507763867623_0.clicked #li_ui_li_gen_1507763867623_0-title-text *, #li_ui_li_gen_1507763867623_0.down #li_ui_li_gen_1507763867623_0-title-text *{color:#fff !important;}#li_ui_li_gen_1507763867623_0 #li_ui_li_gen_1507763867623_0-title #li_ui_li_gen_1507763867623_0-mark{display:inline-block !important;width:0px !important;overflow:hidden !important;}.success #li_ui_li_gen_1507763867623_0 #li_ui_li_gen_1507763867623_0-title{color:#fff !important;border-top-color:#0077b5 !important;border-right-color:#0077b5 !important;border-bottom-color:#0077b5 !important;border-left-color:#0077b5 !important;background-color:#0077b5 !important;background-image:-webkit-gradient(linear, left top, left bottom, color-stop(0%,#0077b5), color-stop(100%,#0077b5)) !important; background-image: -webkit-linear-gradient(top, #0077b5 0%, #0077b5 100%) !important;}.success #li_ui_li_gen_1507763867623_0 #li_ui_li_gen_1507763867623_0-title-text, .success #li_ui_li_gen_1507763867623_0 #li_ui_li_gen_1507763867623_0-title-text *{color:#fff !important;}.IN-shadowed .success #li_ui_li_gen_1507763867623_0 #li_ui_li_gen_1507763867623_0-title{}.success #li_ui_li_gen_1507763867623_0.hovered #li_ui_li_gen_1507763867623_0-title{color:#fff !important;border-top-color:#0369a0 !important;border-right-color:#0369a0 !important;border-bottom-color:#0369a0 !important;border-left-color:#0369a0 !important;background-color:#0369a0 !important;background-image:-webkit-gradient(linear, left top, left bottom, color-stop(0%,#0369a0), color-stop(100%,#0369a0)) !important; background-image: -webkit-linear-gradient(top, #0369a0 0%, #0369a0 100%) !important;}.success #li_ui_li_gen_1507763867623_0.hovered #li_ui_li_gen_1507763867623_0-title-text, .success #li_ui_li_gen_1507763867623_0.hovered #li_ui_li_gen_1507763867623_0-title-text *{color:#fff !important;}.success #li_ui_li_gen_1507763867623_0.clicked #li_ui_li_gen_1507763867623_0-title, .success #li_ui_li_gen_1507763867623_0.down #li_ui_li_gen_1507763867623_0-title{color:#fff !important;border-top-color:#066094 !important;border-right-color:#066094 !important;border-bottom-color:#066094 !important;border-left-color:#066094 !important;background-color:#066094 !important;background-image:-webkit-gradient(linear, left top, left bottom, color-stop(0%,#066094), color-stop(100%,#066094)) !important; background-image: -webkit-linear-gradient(top, #066094 0%, #066094 100%) !important;}.success #li_ui_li_gen_1507763867623_0.clicked #li_ui_li_gen_1507763867623_0-title-text, .success #li_ui_li_gen_1507763867623_0.down #li_ui_li_gen_1507763867623_0-title-text, .success #li_ui_li_gen_1507763867623_0.clicked #li_ui_li_gen_1507763867623_0-title-text *, .success #li_ui_li_gen_1507763867623_0.down #li_ui_li_gen_1507763867623_0-title-text *{color:#fff !important;}.IN-shadowed .success #li_ui_li_gen_1507763867623_0.clicked #li_ui_li_gen_1507763867623_0-title, .IN-shadowed .success #li_ui_li_gen_1507763867623_0.down #li_ui_li_gen_1507763867623_0-title{}#li_ui_li_gen_1507763867639_1-container.IN-right {display:inline-block !important;float:left !important;overflow:visible !important;position:relative !important;height:20px !important;padding-left:2px !important;line-height:1px !important;cursor:pointer !important;}#li_ui_li_gen_1507763867639_1.IN-right {display:block !important;float:left !important;height:20px !important;margin-right:4px !important;padding-right:4px !important;background-image:url(https://static.licdn.com/scds/common/u/images/apps/connect/sprites/sprite_connect_v14.png) !important;background-color:transparent !important;background-repeat:no-repeat !important;background-position:right -447px !important;}#li_ui_li_gen_1507763867639_1-inner.IN-right {display:block !important;float:left !important;padding-left:8px !important;text-align:center !important;background-image:url(https://static.licdn.com/scds/common/u/images/apps/connect/sprites/sprite_connect_v14.png) !important;background-color:transparent !important;background-repeat:no-repeat !important;background-position:0px -426px !important;}#li_ui_li_gen_1507763867639_1-content.IN-right {display:inline !important;font-size:11px !important;color:#4e4e4e !important;font-weight:bold !important;font-family:Arial, sans-serif !important;line-height:20px !important;padding:0 5px 0 5px !important;}#li_ui_li_gen_1507763867639_1-container.IN-empty {display:none !important;}#li_ui_li_gen_1507763867639_1-container.IN-hidden #li_ui_li_gen_1507763867639_1 {display:none !important;}* html #li_ui_li_gen_1507763867644_2 a#li_ui_li_gen_1507763867644_2-link{height:1% !important;}#li_ui_li_gen_1507763867644_2{position:relative !important;overflow:visible !important;display:block !important;}#li_ui_li_gen_1507763867644_2 span{-webkit-box-sizing:content-box !important;-moz-box-sizing:content-box !important;box-sizing:content-box !important;}#li_ui_li_gen_1507763867644_2 a#li_ui_li_gen_1507763867644_2-link{border:0 !important;height:20px !important;text-decoration:none !important;padding:0 !important;margin:0 !important;display:inline-block !important;}#li_ui_li_gen_1507763867644_2 a#li_ui_li_gen_1507763867644_2-link:link, #li_ui_li_gen_1507763867644_2 a#li_ui_li_gen_1507763867644_2-link:visited, #li_ui_li_gen_1507763867644_2 a#li_ui_li_gen_1507763867644_2-link:hover, #li_ui_li_gen_1507763867644_2 a#li_ui_li_gen_1507763867644_2-link:active{border:0 !important;text-decoration:none !important;}#li_ui_li_gen_1507763867644_2 a#li_ui_li_gen_1507763867644_2-link:after{content:"." !important;display:block !important;clear:both !important;visibility:hidden !important;line-height:0 !important;height:0 !important;}#li_ui_li_gen_1507763867644_2 #li_ui_li_gen_1507763867644_2-logo{background-image:url(https://static.licdn.com/scds/common/u/images/apps/connect/sprites/sprite_connect_v14.png) !important;background-position:-56px -423px !important;background-repeat:no-repeat !important;background-color:#0077b5 !important;background-size:135px auto !important;cursor:pointer !important;border:0 !important;border-right:1px solid #066094 !important;text-indent:-9999em !important;overflow:hidden !important;padding:0 !important;margin:0 !important;position:absolute !important;left:0px !important;top:0px !important;display:block !important;width:20px !important;height:20px !important;float:right !important;border-radius:2px !important;-webkit-border-radius:2px !important;border-top-right-radius:2px !important;border-bottom-right-radius:2px !important;-webkit-border-top-right-radius:2px !important;-webkit-border-bottom-right-radius:2px !important;}#li_ui_li_gen_1507763867644_2 #li_ui_li_gen_1507763867644_2-title{color:#fff !important;cursor:pointer !important;display:block !important;white-space:nowrap !important;float:left !important;margin-left:1px !important;vertical-align:top !important;overflow:hidden !important;text-align:center !important;height:18px !important;padding:0 4px 0 23px !important;border:1px solid #000 !important;border-top-color:#0077b5 !important;border-right-color:#0077b5 !important;border-bottom-color:#0077b5 !important;border-left-color:#0077b5 !important;text-shadow:0 -1px #005887 !important;line-height:20px !important;border-radius:2px !important;-webkit-border-radius:2px !important;border-top-right-radius:2px !important;border-bottom-right-radius:2px !important;-webkit-border-top-right-radius:2px !important;-webkit-border-bottom-right-radius:2px !important;background-color:#0077b5 !important;background-image:-webkit-gradient(linear, left top, left bottom, color-stop(0%,#0077b5), color-stop(100%,#0077b5)) !important; background-image: -webkit-linear-gradient(top, #0077b5 0%, #0077b5 100%) !important;}#li_ui_li_gen_1507763867644_2.hovered #li_ui_li_gen_1507763867644_2-title{border:1px solid #000 !important;border-top-color:#0369a0 !important;border-right-color:#0369a0 !important;border-bottom-color:#0369a0 !important;border-left-color:#0369a0 !important;background-color:#0369a0 !important;background-image:-webkit-gradient(linear, left top, left bottom, color-stop(0%,#0369a0), color-stop(100%,#0369a0)) !important; background-image: -webkit-linear-gradient(top, #0369a0 0%, #0369a0 100%) !important;}#li_ui_li_gen_1507763867644_2.clicked #li_ui_li_gen_1507763867644_2-title, #li_ui_li_gen_1507763867644_2.down #li_ui_li_gen_1507763867644_2-title{color:#fff !important;border:1px solid #000 !important;border-top-color:#066094 !important;border-right-color:#066094 !important;border-bottom-color:#066094 !important;border-left-color:#066094 !important;background-color:#066094 !important;background-image:-webkit-gradient(linear, left top, left bottom, color-stop(0%,#066094), color-stop(100%,#066094)) !important; background-image: -webkit-linear-gradient(top, #066094 0%, #066094 100%) !important;}.IN-shadowed #li_ui_li_gen_1507763867644_2 #li_ui_li_gen_1507763867644_2-title{}.IN-shadowed #li_ui_li_gen_1507763867644_2.hovered #li_ui_li_gen_1507763867644_2-title{}.IN-shadowed #li_ui_li_gen_1507763867644_2.clicked #li_ui_li_gen_1507763867644_2-title, .IN-shadowed #li_ui_li_gen_1507763867644_2.down #li_ui_li_gen_1507763867644_2-title{}#li_ui_li_gen_1507763867644_2 #li_ui_li_gen_1507763867644_2-title-text, #li_ui_li_gen_1507763867644_2 #li_ui_li_gen_1507763867644_2-title-text *{color:#fff !important;font-size:11px !important;font-family:Arial, sans-serif !important;font-weight:bold !important;font-style:normal !important;-webkit-font-smoothing:antialiased !important;display:inline-block !important;background:transparent none !important;vertical-align:top !important;height:18px !important;line-height:20px !important;float:none !important;}#li_ui_li_gen_1507763867644_2 #li_ui_li_gen_1507763867644_2-title-text strong{font-weight:bold !important;}#li_ui_li_gen_1507763867644_2 #li_ui_li_gen_1507763867644_2-title-text em{font-style:italic !important;}#li_ui_li_gen_1507763867644_2.hovered #li_ui_li_gen_1507763867644_2-title-text, #li_ui_li_gen_1507763867644_2.hovered #li_ui_li_gen_1507763867644_2-title-text *{color:#fff !important;}#li_ui_li_gen_1507763867644_2.clicked #li_ui_li_gen_1507763867644_2-title-text, #li_ui_li_gen_1507763867644_2.down #li_ui_li_gen_1507763867644_2-title-text, #li_ui_li_gen_1507763867644_2.clicked #li_ui_li_gen_1507763867644_2-title-text *, #li_ui_li_gen_1507763867644_2.down #li_ui_li_gen_1507763867644_2-title-text *{color:#fff !important;}#li_ui_li_gen_1507763867644_2 #li_ui_li_gen_1507763867644_2-title #li_ui_li_gen_1507763867644_2-mark{display:inline-block !important;width:0px !important;overflow:hidden !important;}.success #li_ui_li_gen_1507763867644_2 #li_ui_li_gen_1507763867644_2-title{color:#fff !important;border-top-color:#0077b5 !important;border-right-color:#0077b5 !important;border-bottom-color:#0077b5 !important;border-left-color:#0077b5 !important;background-color:#0077b5 !important;background-image:-webkit-gradient(linear, left top, left bottom, color-stop(0%,#0077b5), color-stop(100%,#0077b5)) !important; background-image: -webkit-linear-gradient(top, #0077b5 0%, #0077b5 100%) !important;}.success #li_ui_li_gen_1507763867644_2 #li_ui_li_gen_1507763867644_2-title-text, .success #li_ui_li_gen_1507763867644_2 #li_ui_li_gen_1507763867644_2-title-text *{color:#fff !important;}.IN-shadowed .success #li_ui_li_gen_1507763867644_2 #li_ui_li_gen_1507763867644_2-title{}.success #li_ui_li_gen_1507763867644_2.hovered #li_ui_li_gen_1507763867644_2-title{color:#fff !important;border-top-color:#0369a0 !important;border-right-color:#0369a0 !important;border-bottom-color:#0369a0 !important;border-left-color:#0369a0 !important;background-color:#0369a0 !important;background-image:-webkit-gradient(linear, left top, left bottom, color-stop(0%,#0369a0), color-stop(100%,#0369a0)) !important; background-image: -webkit-linear-gradient(top, #0369a0 0%, #0369a0 100%) !important;}.success #li_ui_li_gen_1507763867644_2.hovered #li_ui_li_gen_1507763867644_2-title-text, .success #li_ui_li_gen_1507763867644_2.hovered #li_ui_li_gen_1507763867644_2-title-text *{color:#fff !important;}.success #li_ui_li_gen_1507763867644_2.clicked #li_ui_li_gen_1507763867644_2-title, .success #li_ui_li_gen_1507763867644_2.down #li_ui_li_gen_1507763867644_2-title{color:#fff !important;border-top-color:#066094 !important;border-right-color:#066094 !important;border-bottom-color:#066094 !important;border-left-color:#066094 !important;background-color:#066094 !important;background-image:-webkit-gradient(linear, left top, left bottom, color-stop(0%,#066094), color-stop(100%,#066094)) !important; background-image: -webkit-linear-gradient(top, #066094 0%, #066094 100%) !important;}.success #li_ui_li_gen_1507763867644_2.clicked #li_ui_li_gen_1507763867644_2-title-text, .success #li_ui_li_gen_1507763867644_2.down #li_ui_li_gen_1507763867644_2-title-text, .success #li_ui_li_gen_1507763867644_2.clicked #li_ui_li_gen_1507763867644_2-title-text *, .success #li_ui_li_gen_1507763867644_2.down #li_ui_li_gen_1507763867644_2-title-text *{color:#fff !important;}.IN-shadowed .success #li_ui_li_gen_1507763867644_2.clicked #li_ui_li_gen_1507763867644_2-title, .IN-shadowed .success #li_ui_li_gen_1507763867644_2.down #li_ui_li_gen_1507763867644_2-title{}#li_ui_li_gen_1507763867649_3-container.IN-right {display:inline-block !important;float:left !important;overflow:visible !important;position:relative !important;height:20px !important;padding-left:2px !important;line-height:1px !important;cursor:pointer !important;}#li_ui_li_gen_1507763867649_3.IN-right {display:block !important;float:left !important;height:20px !important;margin-right:4px !important;padding-right:4px !important;background-image:url(https://static.licdn.com/scds/common/u/images/apps/connect/sprites/sprite_connect_v14.png) !important;background-color:transparent !important;background-repeat:no-repeat !important;background-position:right -447px !important;}#li_ui_li_gen_1507763867649_3-inner.IN-right {display:block !important;float:left !important;padding-left:8px !important;text-align:center !important;background-image:url(https://static.licdn.com/scds/common/u/images/apps/connect/sprites/sprite_connect_v14.png) !important;background-color:transparent !important;background-repeat:no-repeat !important;background-position:0px -426px !important;}#li_ui_li_gen_1507763867649_3-content.IN-right {display:inline !important;font-size:11px !important;color:#4e4e4e !important;font-weight:bold !important;font-family:Arial, sans-serif !important;line-height:20px !important;padding:0 5px 0 5px !important;}#li_ui_li_gen_1507763867649_3-container.IN-empty {display:none !important;}#li_ui_li_gen_1507763867649_3-container.IN-hidden #li_ui_li_gen_1507763867649_3 {display:none !important;}</style><link type="text/css" href="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/default+en.css" rel="stylesheet"><link type="text/css" href="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/default.css" rel="stylesheet"><script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/default+en.I.js.download"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.gsc-control-cse{font-family:Arial, sans-serif;border-color:#FFFFFF;background-color:#FFFFFF}.gsc-control-cse .gsc-table-result{font-family:Arial, sans-serif}input.gsc-input,.gsc-input-box,.gsc-input-box-hover,.gsc-input-box-focus{border-color:#D9D9D9}input.gsc-search-button,input.gsc-search-button:hover,input.gsc-search-button:focus{border-color:#666666;background-color:#CECECE;background-image:none;filter:none}.gsc-tabHeader.gsc-tabhInactive{border-color:#E9E9E9;background-color:#E9E9E9}.gsc-tabHeader.gsc-tabhActive{border-color:#FF9900;border-bottom-color:#FFFFFF;background-color:#FFFFFF}.gsc-tabsArea{border-color:#FF9900}.gsc-webResult.gsc-result,.gsc-results .gsc-imageResult{border-color:#FFFFFF;background-color:#FFFFFF}.gsc-webResult.gsc-result:hover,.gsc-imageResult:hover{border-color:#FFFFFF;background-color:#FFFFFF}.gs-webResult.gs-result a.gs-title:link,.gs-webResult.gs-result a.gs-title:link b,.gs-imageResult a.gs-title:link,.gs-imageResult a.gs-title:link b{color:#0000CC}.gs-webResult.gs-result a.gs-title:visited,.gs-webResult.gs-result a.gs-title:visited b,.gs-imageResult a.gs-title:visited,.gs-imageResult a.gs-title:visited b{color:#0000CC}.gs-webResult.gs-result a.gs-title:hover,.gs-webResult.gs-result a.gs-title:hover b,.gs-imageResult a.gs-title:hover,.gs-imageResult a.gs-title:hover b{color:#0000CC}.gs-webResult.gs-result a.gs-title:active,.gs-webResult.gs-result a.gs-title:active b,.gs-imageResult a.gs-title:active,.gs-imageResult a.gs-title:active b{color:#0000CC}.gsc-cursor-page{color:#0000CC}a.gsc-trailing-more-results:link{color:#0000CC}.gs-webResult .gs-snippet,.gs-imageResult .gs-snippet,.gs-fileFormatType{color:#000000}.gs-webResult div.gs-visibleUrl,.gs-imageResult div.gs-visibleUrl{color:#008000}.gs-webResult div.gs-visibleUrl-short{color:#008000}.gs-webResult div.gs-visibleUrl-short{display:none}.gs-webResult div.gs-visibleUrl-long{display:block}.gs-promotion div.gs-visibleUrl-short{display:none}.gs-promotion div.gs-visibleUrl-long{display:block}.gsc-cursor-box{border-color:#FFFFFF}.gsc-results .gsc-cursor-box .gsc-cursor-page{border-color:#E9E9E9;background-color:#FFFFFF;color:#0000CC}.gsc-results .gsc-cursor-box .gsc-cursor-current-page{border-color:#FF9900;background-color:#FFFFFF;color:#0000CC}.gsc-webResult.gsc-result.gsc-promotion{border-color:#336699;background-color:#FFFFFF}.gsc-completion-title{color:#0000CC}.gsc-completion-snippet{color:#000000}.gs-promotion a.gs-title:link,.gs-promotion a.gs-title:link *,.gs-promotion .gs-snippet a:link{color:#0000CC}.gs-promotion a.gs-title:visited,.gs-promotion a.gs-title:visited *,.gs-promotion .gs-snippet a:visited{color:#0000CC}.gs-promotion a.gs-title:hover,.gs-promotion a.gs-title:hover *,.gs-promotion .gs-snippet a:hover{color:#0000CC}.gs-promotion a.gs-title:active,.gs-promotion a.gs-title:active *,.gs-promotion .gs-snippet a:active{color:#0000CC}.gs-promotion .gs-snippet,.gs-promotion .gs-title .gs-promotion-title-right,.gs-promotion .gs-title .gs-promotion-title-right *{color:#000000}.gs-promotion .gs-visibleUrl,.gs-promotion .gs-visibleUrl-short{color:#008000}</style><style type="text/css">.gscb_a{display:inline-block;font:27px/13px arial,sans-serif}.gsst_a .gscb_a{color:#a1b9ed;cursor:pointer}.gsst_a:hover .gscb_a,.gsst_a:focus .gscb_a{color:#36c}.gsst_a{display:inline-block}.gsst_a{cursor:pointer;padding:0 4px}.gsst_a:hover{text-decoration:none!important}.gsst_b{font-size:16px;padding:0 2px;position:relative;user-select:none;-webkit-user-select:none;white-space:nowrap}.gsst_e{opacity:0.55;}.gsst_a:hover .gsst_e,.gsst_a:focus .gsst_e{opacity:0.72;}.gsst_a:active .gsst_e{opacity:1;}.gsst_f{background:white;text-align:left}.gsst_g{background-color:white;border:1px solid #ccc;border-top-color:#d9d9d9;box-shadow:0 2px 4px rgba(0,0,0,0.2);-webkit-box-shadow:0 2px 4px rgba(0,0,0,0.2);margin:-1px -3px;padding:0 6px}.gsst_h{background-color:white;height:1px;margin-bottom:-1px;position:relative;top:-1px}.gsib_a{width:100%;padding:4px 6px 0}.gsib_a,.gsib_b{vertical-align:top}.gssb_c{border:0;position:absolute;z-index:989}.gssb_e{border:1px solid #ccc;border-top-color:#d9d9d9;box-shadow:0 2px 4px rgba(0,0,0,0.2);-webkit-box-shadow:0 2px 4px rgba(0,0,0,0.2);cursor:default}.gssb_f{visibility:hidden;white-space:nowrap}.gssb_k{border:0;display:block;position:absolute;top:0;z-index:988}.gsdd_a{border:none!important}.gsq_a{padding:0}.gsq_a{padding:0}.gscsep_a{display:none}.gssb_a{padding:0 7px}.gssb_a,.gssb_a td{white-space:nowrap;overflow:hidden;line-height:22px}#gssb_b{font-size:11px;color:#36c;text-decoration:none}#gssb_b:hover{font-size:11px;color:#36c;text-decoration:underline}.gssb_g{text-align:center;padding:8px 0 7px;position:relative}.gssb_h{font-size:15px;height:28px;margin:0.2em;-webkit-appearance:button}.gssb_i{background:#eee}.gss_ifl{visibility:hidden;padding-left:5px}.gssb_i .gss_ifl{visibility:visible}a.gssb_j{font-size:13px;color:#36c;text-decoration:none;line-height:100%}a.gssb_j:hover{text-decoration:underline}.gssb_l{height:1px;background-color:#e5e5e5}.gssb_m{color:#000;background:#fff}.gsfe_a{border:1px solid #b9b9b9;border-top-color:#a0a0a0;box-shadow:inset 0px 1px 2px rgba(0,0,0,0.1);-moz-box-shadow:inset 0px 1px 2px rgba(0,0,0,0.1);-webkit-box-shadow:inset 0px 1px 2px rgba(0,0,0,0.1);}.gsfe_b{border:1px solid #4d90fe;outline:none;box-shadow:inset 0px 1px 2px rgba(0,0,0,0.3);-moz-box-shadow:inset 0px 1px 2px rgba(0,0,0,0.3);-webkit-box-shadow:inset 0px 1px 2px rgba(0,0,0,0.3);}.gssb_a{padding:0 9px}.gsib_a{padding-right:8px;padding-left:8px}.gsst_a{padding-top:5.5px}.gssb_e{border:0}.gssb_l{margin:5px 0}input.gsc-input::-webkit-input-placeholder{font-size:14px}input.gsc-input:-moz-placeholder{font-size:14px}input.gsc-input::-moz-placeholder{font-size:14px}input.gsc-input:-ms-input-placeholder{font-size:14px}input.gsc-input:focus::-webkit-input-placeholder{color:transparent}input.gsc-input:focus:-moz-placeholder{color:transparent}input.gsc-input:focus::-moz-placeholder{color:transparent}input.gsc-input:focus:-ms-input-placeholder{color:transparent}.gssb_c .gsc-completion-container{position:static}.gssb_c{z-index:5000}.gsc-completion-container table{background:transparent;font-size:inherit;font-family:inherit}.gssb_c > tbody > tr,.gssb_c > tbody > tr > td,.gssb_d,.gssb_d > tbody > tr,.gssb_d > tbody > tr > td,.gssb_e,.gssb_e > tbody > tr,.gssb_e > tbody > tr > td{padding:0;margin:0;border:0}.gssb_a table,.gssb_a table tr,.gssb_a table tr td{padding:0;margin:0;border:0}</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>

<body class="single single-post postid-155893 single-format-standard wpusb-position-fixed-active"><div id="MathJax_Message" style="display: none;"></div>
<!-- begin header -->
<div id="header">
		    	    	<a href="https://www.r-bloggers.com/" class="headerimage"><img src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/R_02_2016-05-01.png" alt="R-bloggers" class="aligncenter" scale="0"></a>
        <div id="description" class="aligncenter">
        R news and tutorials contributed by (750) R bloggers    </div>     
    <div class="main-navigation"><ul id="menu-top-nav" class="sf-menu sf-js-enabled sf-shadow"><li id="menu-item-48314" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-48314"><a href="https://www.r-bloggers.com/">Home</a></li>
<li id="menu-item-92333" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-92333"><a href="https://www.r-bloggers.com/about/">About</a></li>
<li id="menu-item-50111" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-50111"><a href="https://feeds.feedburner.com/RBloggers">RSS</a></li>
<li id="menu-item-48313" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-48313"><a href="https://www.r-bloggers.com/add-your-blog/">add your blog!</a></li>
<li id="menu-item-111419" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-111419"><a href="https://www.r-bloggers.com/how-to-learn-r-2/">Learn R</a></li>
<li id="menu-item-75513" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-75513"><a href="https://www.r-users.com/" class="sf-with-ul">R jobs<span class="sf-sub-indicator">�</span><span class="sf-sub-indicator">�</span><span class="sf-sub-indicator">�</span></a>
<ul class="sub-menu" style="float: none; width: 12em; display: none; visibility: hidden;">
	<li id="menu-item-76945" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-76945" style="white-space: normal; float: left; width: 100%;"><a href="https://www.r-users.com/submit-job/" style="float: none; width: auto;">Submit a new job (it’s free)</a></li>
	<li id="menu-item-76946" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-76946" style="white-space: normal; float: left; width: 100%;"><a href="https://www.r-users.com/" style="float: none; width: auto;">Browse latest jobs (also free)</a></li>
</ul>
</li>
<li id="menu-item-48311" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-48311"><a href="https://www.r-bloggers.com/contact-us/">Contact us</a></li>
</ul></div>
</div>
<!-- end header -->


<div id="mainwrapper">
<!-- begin sidebar -->
    <div id="sidebar">
		<div class="side-widget"><h2>Welcome!</h2>			<div class="textwidget"><iframe allowtransparency="true" frameborder="0" scrolling="no" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/follow_button.html" style="width:164px; height:30px;"></iframe>


Here you will find daily <strong>news and tutorials about R</strong>, contributed by over 750 bloggers. 
<br>
There are many ways to <strong>follow us - </strong>
<br>
<a href="https://feedburner.google.com/fb/a/mailverify?uri=RBloggers">By e-mail:</a>

<form style="border:1px solid #ccc;padding:3px;text-align:center; background: none repeat scroll 0 0 #FDEADA;" action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#39;https://feedburner.google.com/fb/a/mailverify?uri=RBloggers&#39;, &#39;popupwindow&#39;, &#39;scrollbars=yes,width=550,height=520&#39;);return true">
<input type="text" style="width:110px" onclick="if (this.value == &#39;Your e-mail here&#39;) this.value = &#39;&#39;;" value="Your e-mail here" name="email">
<input type="hidden" value="RBloggers" name="uri"><input type="hidden" name="loc" value="en_US"><input type="submit" value="Subscribe">
<a href="https://feeds.feedburner.com/RBloggers"><img src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/RBloggers" height="26" width="88" style="border:0" alt="" scale="0"></a>
</form>



<a href="https://www.facebook.com/rbloggers">On Facebook:</a>
<iframe src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/likebox.html" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:160px; height:238px;" allowtransparency="true"></iframe>


<br>
<strong>If you are an R blogger yourself</strong> you are invited to <a href="https://www.r-bloggers.com/add-your-blog/">add your own R content feed to this site</a> (<strong>Non-English</strong> R bloggers should add themselves- <a href="https://www.r-bloggers.com/lang/add-your-blog">here</a>)</div>
		</div><div class="side-widget"><h2><a class="rsswidget" href="https://feeds.feedburner.com/Rjobs"><img class="rss-widget-icon" style="border:0" width="14" height="14" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/rss.png" alt="RSS" scale="0"></a> <a class="rsswidget" href="https://www.r-users.com/">Jobs for R-users</a></h2><ul><li><a class="rsswidget" href="http://feedproxy.google.com/~r/RJobs/~3/f0ldKrD49UA/">PROGRAMMER/SOFTWARE DEVELOPMENT ENGINEER/COMPUTATIONAL AND MACHINE LEARNING SPECIALIST</a></li><li><a class="rsswidget" href="http://feedproxy.google.com/~r/RJobs/~3/OMCwwBo1veo/">Quantitative Econometrician @ San Francisco, California, U.S.</a></li><li><a class="rsswidget" href="http://feedproxy.google.com/~r/RJobs/~3/X3DpiECQ8DE/">Postdoctoral Research Fellow in Healthcare Systems Engineering @ Maryland, U.S.</a></li><li><a class="rsswidget" href="http://feedproxy.google.com/~r/RJobs/~3/xPASaTEn8kE/">R Programmer &amp; Statistician for Academic Research</a></li><li><a class="rsswidget" href="http://feedproxy.google.com/~r/RJobs/~3/8QL91gt7zzc/">Data Scientist</a></li></ul></div><div class="side-widget"><h2>Popular Searches</h2></div>		<div class="side-widget">		<h2>Recent Posts</h2>		<ul>
					<li>
				<a href="https://www.r-bloggers.com/comparing-smooths-in-factor-smooth-interactions-i/">Comparing smooths in factor-smooth interactions I</a>
						</li>
					<li>
				<a href="https://www.r-bloggers.com/rs-remarkable-growth/">R’s remarkable growth</a>
						</li>
					<li>
				<a href="https://www.r-bloggers.com/text-mining-with-r-upcoming-courses-in-belgium/">Text Mining with R – upcoming courses in Belgium</a>
						</li>
					<li>
				<a href="https://www.r-bloggers.com/weird-al-yankovise-a-2-chainz-lyric/">Weird Al Yankovise() a 2 Chainz Lyric</a>
						</li>
					<li>
				<a href="https://www.r-bloggers.com/earl-boston-must-see-sessions-and-15-off/">EARL Boston must see sessions and 15% off!</a>
						</li>
					<li>
				<a href="https://www.r-bloggers.com/changes-to-internet-connectivity-in-r-on-windows/">Changes to Internet Connectivity in R on Windows</a>
						</li>
					<li>
				<a href="https://www.r-bloggers.com/announcing-dplyrxdf-1-0/">Announcing dplyrXdf 1.0</a>
						</li>
					<li>
				<a href="https://www.r-bloggers.com/enabling-concerned-visitors-ethical-security-researchers-with-security-txt-web-security-policies-plus-analyze-them-at-scale-with-r/">Enabling Concerned Visitors &amp; Ethical Security Researchers with security.txt Web Security Policies (plus analyze them at-scale with R)</a>
						</li>
					<li>
				<a href="https://www.r-bloggers.com/rstudio-v1-1-released/">RStudio v1.1 Released</a>
						</li>
					<li>
				<a href="https://www.r-bloggers.com/genome-wide-association-studies-in-r/">Genome-wide association studies in R</a>
						</li>
					<li>
				<a href="https://www.r-bloggers.com/celebrating-20-years-of-cran/">Celebrating 20 years of CRAN</a>
						</li>
					<li>
				<a href="https://www.r-bloggers.com/the-hitchhikers-guide-to-ggplot2-in-r-5/">The Hitchhiker’s Guide to Ggplot2 in R</a>
						</li>
					<li>
				<a href="https://www.r-bloggers.com/summer-astrostat-school-room-with-a-view-jatp/">[summer Astrostat school] room with a view [jatp]</a>
						</li>
					<li>
				<a href="https://www.r-bloggers.com/climate-change-and-population-modeling-in-r/">Climate Change and Population Modeling in R</a>
						</li>
					<li>
				<a href="https://www.r-bloggers.com/how-to-sample-from-multidimensional-distributions-using-gibbs-sampling/">How to sample from multidimensional distributions using Gibbs sampling?</a>
						</li>
				</ul>
		</div>		<div class="side-widget"><h2>Other sites</h2>
	<ul class="xoxo blogroll">
<li><a href="https://www.r-users.com/">Jobs for R-users</a></li>
<li><a href="http://www.proc-x.com/" title="SAS news gathered from bloggers">SAS blogs</a></li>

	</ul>
</div>
    </div>
<!-- end sidebar -->	<div id="leftcontent">
	
		

	<div id="post-155893" class="post-155893 post type-post status-publish format-standard hentry category-r-bloggers">
					
				
                <h1>Comparing smooths in factor-smooth interactions I</h1>
                <div class="meta"><div class="date">October 10, 2017</div>By <a href="https://www.r-bloggers.com/author/gavin-l-simpson/" title="Posts by Gavin L. Simpson" rel="author">Gavin L. Simpson</a></div><div class="entry"><p class="syndicated-attribution"></p><div class="social4i" style="height:29px;"><div class="social4in" style="height:29px;float: left;"><div class="socialicons s4fblike" style="float:left;margin-right: 10px;"><div class="fb-like fb_iframe_widget" data-href="https://www.r-bloggers.com/comparing-smooths-in-factor-smooth-interactions-i/" data-send="true" data-layout="button_count" data-width="100" data-height="21" data-show-faces="false" fb-xfbml-state="rendered" fb-iframe-plugin-query="app_id=&amp;container_width=0&amp;height=21&amp;href=https%3A%2F%2Fwww.r-bloggers.com%2Fcomparing-smooths-in-factor-smooth-interactions-i%2F&amp;layout=button_count&amp;locale=en_US&amp;sdk=joey&amp;send=true&amp;show_faces=false&amp;width=100"><span style="vertical-align: bottom; width: 112px; height: 20px;"><iframe name="f3941ecdc58f91" width="100px" height="21px" frameborder="0" allowtransparency="true" allowfullscreen="true" scrolling="no" title="fb:like Facebook Social Plugin" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/like.html" style="border: none; visibility: visible; width: 112px; height: 20px;" class=""></iframe></span></div></div><div class="socialicons s4linkedin" style="float:left;margin-right: 10px;"><span class="IN-widget" style="line-height: 1; vertical-align: baseline; display: inline-block; text-align: center;"><span style="padding: 0px !important; margin: 0px !important; text-indent: 0px !important; display: inline-block !important; vertical-align: baseline !important; font-size: 1px !important;"><span id="li_ui_li_gen_1507763867623_0"><a id="li_ui_li_gen_1507763867623_0-link" href="javascript:void(0);"><span id="li_ui_li_gen_1507763867623_0-logo">in</span><span id="li_ui_li_gen_1507763867623_0-title"><span id="li_ui_li_gen_1507763867623_0-mark"></span><span id="li_ui_li_gen_1507763867623_0-title-text">Share</span></span></a></span></span><span style="padding: 0px !important; margin: 0px !important; text-indent: 0px !important; display: inline-block !important; vertical-align: baseline !important; font-size: 1px !important;"><span id="li_ui_li_gen_1507763867639_1-container" class="IN-right"><span id="li_ui_li_gen_1507763867639_1" class="IN-right"><span id="li_ui_li_gen_1507763867639_1-inner" class="IN-right"><span id="li_ui_li_gen_1507763867639_1-content" class="IN-right">1</span></span></span></span></span></span><script type="in/share+init" data-url="https://www.r-bloggers.com/comparing-smooths-in-factor-smooth-interactions-i/" data-counter="right"></script></div></div><div style="clear:both"></div></div>

<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;">
(This article was first published on  <strong><a href="http://www.fromthebottomoftheheap.net/2017/10/10/difference-splines-i/"> From the Bottom of the Heap - R</a></strong>, and kindly contributed to <a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers)</a>      
</div><p></p>
<aside class="mashsb-container mashsb-main mashsb-stretched"><div class="mashsb-box"><div class="mashsb-buttons"><a class="mashicon-facebook mash-small mash-center mashsb-noshadow" href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fwww.r-bloggers.com%2Fcomparing-smooths-in-factor-smooth-interactions-i%2F" target="_blank" rel="nofollow"><span class="icon"></span><span class="text">Share</span></a><a class="mashicon-twitter mash-small mash-center mashsb-noshadow" href="https://twitter.com/intent/tweet?text=Comparing%20smooths%20in%20factor-smooth%20interactions%20I&amp;url=https://www.r-bloggers.com/comparing-smooths-in-factor-smooth-interactions-i/&amp;via=Rbloggers" target="_blank" rel="nofollow"><span class="icon"></span><span class="text">Tweet</span></a><div class="onoffswitch2 mash-small mashsb-noshadow" style="display:none;"></div></div>
            </div>
                <div style="clear:both;"></div></aside>
            <!-- Share buttons by mashshare.net - Version: 3.4.4--><p>
One of the really appealing features of the <strong>mgcv</strong> package for fitting GAMs is the functionality it exposes for fitting quite complex models, models that lie well beyond what many of us may have learned about what GAMs can do. One of those features that I use a lot is the ability to model the smooth effects of some covariate <span class="math inline">(x)</span> in the different levels of a factor. Having estimated a separate smoother for each level of the factor, the obvious question is, which smooths are different? In this post I’ll take a look at one way to do this using <code>by</code>-variable smooths.
</p>
<p>
With <strong>mgcv</strong>, smooths are included in model formulae using the <code>s()</code> function. If you want to have the smooth equivalent of a continuous-factor interaction, one way to achieve this is via the <code>by</code> argument to <code>s()</code>. If you pass a factor to <code>by</code>, <strong>mgcv</strong> sets up the model matrix in such a way that you get a separate smoother for each level of the <code>by</code> factor. Each of these smoothers gets its own smoothness parameter — so you can fit a wiggly function in level <em>foo</em> and a smooth function in level <em>bar</em>, with each level’s function being learned from the data associated with that level.
</p>
<p>
I used this technique in a <a href="http://doi.org/10.1016/j.gca.2010.12.026" rel="nofollow" target="_blank">paper</a> I wrote with my colleagues at UCL, Neil Rose, Handong Yang, and Simon Turner <span class="citation" data-cites="Rose2012-pl">(Rose et al., 2012)</span>. Neil, Handong, and Simon had collected sediment cores from several Scottish lochs and measured metal concentrations, especially of lead (Pb) and mercury (Hg), in sediment slices covering the last 200 years. The aim of the study was to investigate sediment profiles of these metals in three regions of Scotland; north east, north west, and south west. A pair of lochs in each region was selected, one in a catchment with visibly eroding peat/soil, and the other in a catchment without erosion. The different regions represented variations in historical deposition levels, whilst the hypothesis was that cores from eroded and non-eroded catchments would show differential responses to reductions in emissions of Pb and Hg to the atmosphere. The difference, it was hypothesised, was that the eroding soil acts as a secondary source of pollutants to the lake. You can read more about it in the <a href="http://doi.org/10.1016/j.gca.2010.12.026" rel="nofollow" target="_blank">paper</a> — if you’re interested but don’t have access to the journal, send me an email and I’ll pass on a pdf.
</p>
<p>
It was relatively simple to fit splines to each sediment profile, but once I’d done this, how were we going to estimate the difference between the fitted trends? Thankfully, I already had the answer as Simon Wood had supplied code to do it to an OP on the R-Help listserver some years previous. That answer involved <code>by</code>-variable smoothers, which I was already using, and the use of the <span class="math inline">(Xp)</span> matrix of the fitted GAM.
</p>
<p>
Readers of this blog will have heard about the <span class="math inline">(Xp)</span> matrix before; it’s used a lot when we want to simulate from the posterior of the estimated model. Importantly, for our purposes, it allows for the creation of derived quantities, from the fitted model, and the assignment of uncertainty to those quantities.
</p>
<p>
In this post I’ll illustrate how to do the required comparison using some of the data from that study on Scottish lochs.
</p>
<p>
In this post I’ll use the the following packages
</p>
<ul>
<li>
<strong>readr</strong>
</li>
<li>
<strong>dplyr</strong>
</li>
<li>
<strong>ggplot2</strong>, and
</li>
<li>
<strong>mgcv</strong>
</li>
</ul>
<p>
You’ll more than likely have these installed, but if you get errors about missing packages when you run the code chunk below, install any missing packages and run the chunk again
</p>
<figure class="highlight">
<pre><code class="language-r" data-lang="r"><span class="n">library</span><span class="p">(</span><span class="s1">'readr'</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="s1">'dplyr'</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="s1">'ggplot2'</span><span class="p">)</span><span class="w">
</span><span class="n">theme_set</span><span class="p">(</span><span class="n">theme_bw</span><span class="p">())</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="s1">'mgcv'</span><span class="p">)</span></code></pre>
</figure>
<p>
Next, load the data set and convert the <code>SiteCode</code> variable to a factor for use in fitting the GAM with <code>gam()</code>
</p>
<figure class="highlight">
<pre><code class="language-r" data-lang="r"><span class="n">uri</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s1">'<a class="vglnk" href="https://gist.githubusercontent.com/gavinsimpson/eb4ff24fa9924a588e6ee60dfae8746f/raw/geochimica-metals.csv" rel="nofollow"><span>https</span><span>://</span><span>gist</span><span>.</span><span>githubusercontent</span><span>.</span><span>com</span><span>/</span><span>gavinsimpson</span><span>/</span><span>eb4ff24fa9924a588e6ee60dfae8746f</span><span>/</span><span>raw</span><span>/</span><span>geochimica</span><span>-</span><span>metals</span><span>.</span><span>csv</span></a>'</span><span class="w">
</span><span class="n">metals</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read_csv</span><span class="p">(</span><span class="n">uri</span><span class="p">,</span><span class="w"> </span><span class="n">skip</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">col_types</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s1">'ciccd'</span><span class="p">))</span><span class="w">
</span><span class="n">metals</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mutate</span><span class="p">(</span><span class="n">metals</span><span class="p">,</span><span class="w"> </span><span class="n">SiteCode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">factor</span><span class="p">(</span><span class="n">SiteCode</span><span class="p">))</span></code></pre>
</figure>
<p>
This is a subset of the data used in <span class="citation" data-cites="Rose2012-pl">Rose et al. (2012)</span> — the Hg concentrations in the sediments for just three of the lochs are included here in the interests of simplicity. The data set contains 5 variables
</p>
<figure class="highlight">
<pre><code class="language-r" data-lang="r"><span class="n">metals</span></code></pre>
</figure>
<figure class="highlight">
<pre><code class="language-text" data-lang="text"># A tibble: 44 x 5
   SiteCode  Date SoilType Region        Hg
     <fctr> <int>    <chr>  <chr>     <dbl>
 1     CHNA  2000     thin     NW  3.843399
 2     CHNA  1990     thin     NW  5.424618
 3     CHNA  1980     thin     NW  8.819730
 4     CHNA  1970     thin     NW 11.417457
 5     CHNA  1960     thin     NW 16.513540
 6     CHNA  1950     thin     NW 16.512047
 7     CHNA  1940     thin     NW 11.188840
 8     CHNA  1930     thin     NW 11.622222
 9     CHNA  1920     thin     NW 13.645853
10     CHNA  1910     thin     NW 11.181711
# ... with 34 more rows</dbl></chr></chr></int></fctr></code></pre>
</figure>
<ul>
<li>
<code>SiteCode</code> is a factor indexing the three lochs, with levels <code>CHNA</code>, <code>FION</code>, and <code>NODH</code>,
</li>
<li>
<code>Date</code> is a numeric variable of sediment age per sample,
</li>
<li>
<code>SoilType</code> and <code>Region</code> are additional factors for the (natural) experimental design, and
</li>
<li>
<code>Hg</code> is the response variable of interest, and contains the Hg concentration of each sediment sample.
</li>
</ul>
<p>
Neil gave me permission to make these data available openly should you want to try this approach out for yourself. If you make use of the data for other purposes, please cite the source publication <span class="citation" data-cites="Rose2012-pl">(Rose et al., 2012)</span> and recognize the contribution of the data creators; Handong Yang, Simon Turner, and Neil Rose.
</p>
<p>
The data, with LOESS smoothers superimposed, are shown below
</p>
<figure class="highlight">
<pre><code class="language-r" data-lang="r"><span class="n">ggplot</span><span class="p">(</span><span class="n">metals</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Date</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Hg</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SiteCode</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">geom_smooth</span><span class="p">(</span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'loess'</span><span class="p">,</span><span class="w"> </span><span class="n">se</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">scale_colour_brewer</span><span class="p">(</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'qual'</span><span class="p">,</span><span class="w"> </span><span class="n">palette</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Dark2'</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'top'</span><span class="p">)</span></code></pre>
</figure>
<figure>
<img src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/difference-smooths-i-plot-data-1.png" data-lazy-loaded="true" style="display: inline;" width="456" height="256" src-orig="https://i1.wp.com/www.fromthebottomoftheheap.net/assets/img/posts/difference-smooths-i-plot-data-1.png?w=456" scale="1.375"><noscript>&lt;img src="<a class="vglnk" href="https://i1.wp.com/www.fromthebottomoftheheap.net/assets/img/posts/difference-smooths-i-plot-data-1.png?w=456" rel="nofollow"><span>https</span><span>://</span><span>i1</span><span>.</span><span>wp</span><span>.</span><span>com</span><span>/</span><span>www</span><span>.</span><span>fromthebottomoftheheap</span><span>.</span><span>net</span><span>/</span><span>assets</span><span>/</span><span>img</span><span>/</span><span>posts</span><span>/</span><span>difference</span><span>-</span><span>smooths</span><span>-</span><span>i</span><span>-</span><span>plot</span><span>-</span><span>data</span><span>-</span><span>1</span><span>.</span><span>png</span><span>?</span><span>w</span><span>=</span><span>456</span></a>" data-recalc-dims="1" /&gt;</noscript><br>
</figure>
<p>
Smooth-factor interactions can be estimated using <code>gam()</code> in a number of different ways. Here we use <code>by</code>-variable smooths. Each of the separate smooths is subject to identifiability constraints, which effectively centres each smooth around zero effect. As such, differences in the mean Hg concentrations of the lochs is not accounted for by the smooths. The rectify this we’ll need to add <code>SiteCode</code> as a parametric term to the model, along with the smooths.
</p>
<p>
The GAM is fitted to the three sites, and the fit summarized, using the following code
</p>
<figure class="highlight">
<pre><code class="language-r" data-lang="r"><span class="n">m</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">gam</span><span class="p">(</span><span class="n">Hg</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">SiteCode</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">s</span><span class="p">(</span><span class="n">Date</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SiteCode</span><span class="p">),</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">metals</span><span class="p">)</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">m</span><span class="p">)</span></code></pre>
</figure>
<figure class="highlight">
<pre><code class="language-text" data-lang="text">Family: gaussian 
Link function: identity 

Formula:
Hg ~ SiteCode + s(Date, by = SiteCode)

Parametric coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   10.2970     0.7889  13.052 2.19e-12 ***
SiteCodeFION   2.3260     1.1163   2.084 0.048026 *  
SiteCodeNODH   5.5587     1.3288   4.183 0.000332 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Approximate significance of smooth terms:
                       edf Ref.df      F  p-value    
s(Date):SiteCodeCHNA 2.744  3.412  3.786   0.0187 *  
s(Date):SiteCodeFION 5.711  6.861 18.745 7.66e-12 ***
s(Date):SiteCodeNODH 8.574  8.922 19.086 7.62e-15 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

R-sq.(adj) =  0.889   Deviance explained = 93.8%
GCV = 17.076  Scale est. = 9.3029    n = 44</code></pre>
</figure>
<p>
and the resulting smooths can be drawn using the <code>plot()</code> method
</p>
<figure class="highlight">
<pre><code class="language-r" data-lang="r"><span class="n">plot</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">shade</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">pages</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">scale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">)</span></code></pre>
</figure>
<figure>
<img src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/difference-smooths-i-plot-smooths-1.png" alt="Estimated smooths for each level of factor SiteCode" data-lazy-loaded="true" style="display: inline;" width="456" height="342" src-orig="https://i0.wp.com/www.fromthebottomoftheheap.net/assets/img/posts/difference-smooths-i-plot-smooths-1.png?w=456" scale="1.375"><noscript>&lt;img src="<a class="vglnk" href="https://i0.wp.com/www.fromthebottomoftheheap.net/assets/img/posts/difference-smooths-i-plot-smooths-1.png?w=456" rel="nofollow"><span>https</span><span>://</span><span>i0</span><span>.</span><span>wp</span><span>.</span><span>com</span><span>/</span><span>www</span><span>.</span><span>fromthebottomoftheheap</span><span>.</span><span>net</span><span>/</span><span>assets</span><span>/</span><span>img</span><span>/</span><span>posts</span><span>/</span><span>difference</span><span>-</span><span>smooths</span><span>-</span><span>i</span><span>-</span><span>plot</span><span>-</span><span>smooths</span><span>-</span><span>1</span><span>.</span><span>png</span><span>?</span><span>w</span><span>=</span><span>456</span></a>" alt="Estimated smooths for each level of factor SiteCode" data-recalc-dims="1" /&gt;</noscript><p></p>
<figcaption>
Estimated smooths for each level of factor <code>SiteCode</code><br>
</figcaption>
</figure>
<h2 id="differences-of-smooths">
Differences of smooths<br>
</h2>
<p>
To calculate the differences between pairs of the three smooths estimated in the model we need to be able to evaluate the smooths at a set of values of <code>Date</code>. Below we specify a fine gird of points over the time-scale of each core. This set of prediction data is passed to the <code>predict()</code> method and the <span class="math inline">(Xp)</span> matrix is requested with the option <code>type = ‘lpmatrix’</code>
</p>
<figure class="highlight">
<pre><code class="language-r" data-lang="r"><span class="n">pdat</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">expand.grid</span><span class="p">(</span><span class="n">Date</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="m">1860</span><span class="p">,</span><span class="w"> </span><span class="m">2000</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">400</span><span class="p">),</span><span class="w">
                    </span><span class="n">SiteCode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s1">'FION'</span><span class="p">,</span><span class="w"> </span><span class="s1">'CHNA'</span><span class="p">,</span><span class="w"> </span><span class="s1">'NODH'</span><span class="p">))</span><span class="w">
</span><span class="n">xp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">newdata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pdat</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'lpmatrix'</span><span class="p">)</span></code></pre>
</figure>
<p>
The result, stored in <code>xp</code>, is a matrix where the basis functions of the model have been evaluated at the values of the covariates supplied to <code>newdata</code>. To turn this matrix into one containing fitted or predicted values it needs the be muliplied by the model coefficients and the rows summed. However, in this <span class="math inline">(Xp)</span> state we can compute differences between the evaluated smooths before computing fitted values.
</p>
<p>
This process needs to be repeated for each pair of smooths we want to compare — this is a bit like all pair-wise post hoc comparisons. A number of steps are involved, which I break down below for the comparison of the smooths for <code>SiteCode == ‘CHNA’</code> and <code>SiteCode = ‘FION’</code>. After I’ve gone through the steps, we’ll wrap them all into a function which we can use to automated the process.
</p>
<p>
The first step is to identify which columns of <span class="math inline">(Xp)</span> relate to the smooths for the pair of levels of <code>SiteCode</code> we are comparing. The rows of the <span class="math inline">(Xp)</span> that contain the data for this pair of lochs also need to be identified.
</p>
<figure class="highlight">
<pre><code class="language-r" data-lang="r"><span class="c1">## which cols of xp relate to splines of interest?
</span><span class="n">c</span><span class="m">1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">grepl</span><span class="p">(</span><span class="s1">'CHNA'</span><span class="p">,</span><span class="w"> </span><span class="n">colnames</span><span class="p">(</span><span class="n">xp</span><span class="p">))</span><span class="w">
</span><span class="n">c</span><span class="m">2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">grepl</span><span class="p">(</span><span class="s1">'FION'</span><span class="p">,</span><span class="w"> </span><span class="n">colnames</span><span class="p">(</span><span class="n">xp</span><span class="p">))</span><span class="w">
</span><span class="c1">## which rows of xp relate to sites of interest?
</span><span class="n">r</span><span class="m">1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">with</span><span class="p">(</span><span class="n">pdat</span><span class="p">,</span><span class="w"> </span><span class="n">SiteCode</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">'CHNA'</span><span class="p">)</span><span class="w">
</span><span class="n">r</span><span class="m">2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">with</span><span class="p">(</span><span class="n">pdat</span><span class="p">,</span><span class="w"> </span><span class="n">SiteCode</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">'FION'</span><span class="p">)</span></code></pre>
</figure>
<p>
Next, we subtract the elements of <span class="math inline">(Xp)</span> for the first loch from the elements of <span class="math inline">(Xp)</span> for the second loch. To focus on the difference between the pair of smooths, the columns of the differenced <span class="math inline">(Xp)</span> matrix (in <code>X</code>) that aren’t involved in comparison are set then to zero
</p>
<figure class="highlight">
<pre><code class="language-r" data-lang="r"><span class="c1">## difference rows of xp for data from comparison
</span><span class="n">X</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">xp</span><span class="p">[</span><span class="n">r</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">xp</span><span class="p">[</span><span class="n">r</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="p">]</span><span class="w">
</span><span class="c1">## zero out cols of X related to splines for other lochs
</span><span class="n">X</span><span class="p">[,</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="m">1</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">c</span><span class="m">2</span><span class="p">)]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">0</span><span class="w">
</span><span class="c1">## zero out the parametric cols
</span><span class="n">X</span><span class="p">[,</span><span class="w"> </span><span class="o">!</span><span class="n">grepl</span><span class="p">(</span><span class="s1">'^s\\('</span><span class="p">,</span><span class="w"> </span><span class="n">colnames</span><span class="p">(</span><span class="n">xp</span><span class="p">))]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">0</span></code></pre>
</figure>
<p>
The first zeroing uses the logical indices for columns containing either <code>‘CHNA’</code> or <code>‘FION’</code> — if you had a model with additional smooths involving the <code>SiteCode</code> variable, you’d need a more sophisticated way of identifying the columns of <span class="math inline">(Xp)</span> that relate to the smooths of interest. The second zeroing affects all the columns related to the parametric terms in the model. For this model these relate to the intercept and the two dummy contrasts associated with <code>SiteCode</code> in the model.
</p>
<p>
Having obtained a suitably modified <span class="math inline">(Xp)</span> matrix, predicted values using it can be obtained by multiplying the matrix by the estimated model coefficients and summing the result row-wise. This can be achieved in a single step using a matrix multiplication of the matrix <code>X</code> with the row vector of model coefficients.
</p>
<figure class="highlight">
<pre><code class="language-r" data-lang="r"><span class="n">dif</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="o">%*%</span><span class="w"> </span><span class="n">coef</span><span class="p">(</span><span class="n">m</span><span class="p">)</span></code></pre>
</figure>
<p>
Because we zeroed out all the columns not involved directly in the pair of smooths we are comparing, this effectively turns their contributions to the fitted/predicted values to zero also. The result, stored in <code>dif</code>, is a vector of fitted <em>differences</em> between the pair of smooths we an interested in.
</p>
<p>
Having computed the difference, we want to know how uncertain the estimated difference is. Handily, we can compute the standard errors of the differences using the variance-covariance matrix of the estimated model coefficients. The standard errors are computed using
</p>
<figure class="highlight">
<pre><code class="language-r" data-lang="r"><span class="n">se</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rowSums</span><span class="p">((</span><span class="n">X</span><span class="w"> </span><span class="o">%*%</span><span class="w"> </span><span class="n">vcov</span><span class="p">(</span><span class="n">m</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">X</span><span class="p">)</span></code></pre>
</figure>
<p>
Note that the above assumes that smoothness parameters (which control how wiggly the individual smooths are) are known and fixed. In reality these smoothness parameters were estimated and hence the standard errors just computed are likely biased low. This could be corrected by passing <code>unconditional = TRUE</code> to <code>vcov()</code>.
</p>
<p>
Now that we have standard errors, a point-wise 1 – <span class="math inline">()</span> confidence interval can be created using the critical value of the <em>t</em> distribution with appropriate degrees of freedom (in the case of a Gaussian model; quantiles of the Gaussian distribution would be needed for other conditional distributions). For a 95% interval, we use the following code
</p>
<figure class="highlight">
<pre><code class="language-r" data-lang="r"><span class="n">crit</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">qt</span><span class="p">(</span><span class="m">.975</span><span class="p">,</span><span class="w"> </span><span class="n">df.residual</span><span class="p">(</span><span class="n">m</span><span class="p">))</span><span class="w">
</span><span class="n">upr</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dif</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">crit</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">se</span><span class="p">)</span><span class="w">
</span><span class="n">lwr</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dif</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">crit</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">se</span><span class="p">)</span></code></pre>
</figure>
<p>
To allow for these steps to be repeated for all pairwise combinations, the process outlined above is best encapsulated as a function. One such function is shown below, where arguments <code>f1</code>, <code>f2</code>, and <code>var</code> refer to length 1 character vectors specifying the first and second levels of the factor and the name of the <code>by</code>-variable factor respectively.
</p>
<figure class="highlight">
<pre><code class="language-r" data-lang="r"><span class="n">smooth_diff</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="w"> </span><span class="n">newdata</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">var</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.05</span><span class="p">,</span><span class="w">
                        </span><span class="n">unconditional</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">xp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="w"> </span><span class="n">newdata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newdata</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'lpmatrix'</span><span class="p">)</span><span class="w">
    </span><span class="n">c</span><span class="m">1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">grepl</span><span class="p">(</span><span class="n">f</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">colnames</span><span class="p">(</span><span class="n">xp</span><span class="p">))</span><span class="w">
    </span><span class="n">c</span><span class="m">2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">grepl</span><span class="p">(</span><span class="n">f</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">colnames</span><span class="p">(</span><span class="n">xp</span><span class="p">))</span><span class="w">
    </span><span class="n">r</span><span class="m">1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">newdata</span><span class="p">[[</span><span class="n">var</span><span class="p">]]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">f</span><span class="m">1</span><span class="w">
    </span><span class="n">r</span><span class="m">2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">newdata</span><span class="p">[[</span><span class="n">var</span><span class="p">]]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">f</span><span class="m">2</span><span class="w">
    </span><span class="c1">## difference rows of xp for data from comparison
</span><span class="w">    </span><span class="n">X</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">xp</span><span class="p">[</span><span class="n">r</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">xp</span><span class="p">[</span><span class="n">r</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="p">]</span><span class="w">
    </span><span class="c1">## zero out cols of X related to splines for other lochs
</span><span class="w">    </span><span class="n">X</span><span class="p">[,</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="m">1</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">c</span><span class="m">2</span><span class="p">)]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">0</span><span class="w">
    </span><span class="c1">## zero out the parametric cols
</span><span class="w">    </span><span class="n">X</span><span class="p">[,</span><span class="w"> </span><span class="o">!</span><span class="n">grepl</span><span class="p">(</span><span class="s1">'^s\\('</span><span class="p">,</span><span class="w"> </span><span class="n">colnames</span><span class="p">(</span><span class="n">xp</span><span class="p">))]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">0</span><span class="w">
    </span><span class="n">dif</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="o">%*%</span><span class="w"> </span><span class="n">coef</span><span class="p">(</span><span class="n">model</span><span class="p">)</span><span class="w">
    </span><span class="n">se</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rowSums</span><span class="p">((</span><span class="n">X</span><span class="w"> </span><span class="o">%*%</span><span class="w"> </span><span class="n">vcov</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="w"> </span><span class="n">unconditional</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">unconditional</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">X</span><span class="p">)</span><span class="w">
    </span><span class="n">crit</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">qt</span><span class="p">(</span><span class="n">alpha</span><span class="o">/</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">df.residual</span><span class="p">(</span><span class="n">model</span><span class="p">),</span><span class="w"> </span><span class="n">lower.tail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span><span class="w">
    </span><span class="n">upr</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dif</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">crit</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">se</span><span class="p">)</span><span class="w">
    </span><span class="n">lwr</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dif</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">crit</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">se</span><span class="p">)</span><span class="w">
    </span><span class="n">data.frame</span><span class="p">(</span><span class="n">pair</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">paste</span><span class="p">(</span><span class="n">f</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">sep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'-'</span><span class="p">),</span><span class="w">
               </span><span class="n">diff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dif</span><span class="p">,</span><span class="w">
               </span><span class="n">se</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">se</span><span class="p">,</span><span class="w">
               </span><span class="n">upper</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">upr</span><span class="p">,</span><span class="w">
               </span><span class="n">lower</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lwr</span><span class="p">)</span><span class="w">
</span><span class="p">}</span></code></pre>
</figure>
<p>
To complete the pairwise comparison of the estimated smooths, we use the function on the three combinations of pairs of smooths and gather the results into a tidy object <code>comp</code> suitable for plotting with <strong>ggplot2</strong>
</p>
<figure class="highlight">
<pre><code class="language-r" data-lang="r"><span class="n">comp1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">smooth_diff</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">pdat</span><span class="p">,</span><span class="w"> </span><span class="s1">'FION'</span><span class="p">,</span><span class="w"> </span><span class="s1">'CHNA'</span><span class="p">,</span><span class="w"> </span><span class="s1">'SiteCode'</span><span class="p">)</span><span class="w">
</span><span class="n">comp2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">smooth_diff</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">pdat</span><span class="p">,</span><span class="w"> </span><span class="s1">'FION'</span><span class="p">,</span><span class="w"> </span><span class="s1">'NODH'</span><span class="p">,</span><span class="w"> </span><span class="s1">'SiteCode'</span><span class="p">)</span><span class="w">
</span><span class="n">comp3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">smooth_diff</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">pdat</span><span class="p">,</span><span class="w"> </span><span class="s1">'CHNA'</span><span class="p">,</span><span class="w"> </span><span class="s1">'NODH'</span><span class="p">,</span><span class="w"> </span><span class="s1">'SiteCode'</span><span class="p">)</span><span class="w">
</span><span class="n">comp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cbind</span><span class="p">(</span><span class="n">date</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="m">1860</span><span class="p">,</span><span class="w"> </span><span class="m">2000</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">400</span><span class="p">),</span><span class="w">
              </span><span class="n">rbind</span><span class="p">(</span><span class="n">comp1</span><span class="p">,</span><span class="w"> </span><span class="n">comp2</span><span class="p">,</span><span class="w"> </span><span class="n">comp3</span><span class="p">))</span></code></pre>
</figure>
<p>
The pairwise differences of smooths and associated confidence intervals can be plotted using
</p>
<figure class="highlight">
<pre><code class="language-r" data-lang="r"><span class="n">ggplot</span><span class="p">(</span><span class="n">comp</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">date</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">diff</span><span class="p">,</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pair</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">geom_ribbon</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">ymin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lower</span><span class="p">,</span><span class="w"> </span><span class="n">ymax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">upper</span><span class="p">),</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">geom_line</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="w"> </span><span class="n">pair</span><span class="p">,</span><span class="w"> </span><span class="n">ncol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">coord_cartesian</span><span class="p">(</span><span class="n">ylim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">-30</span><span class="p">,</span><span class="m">30</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Difference in Hg trend'</span><span class="p">)</span></code></pre>
</figure>
<figure>
<img src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/difference-smooths-i-plot-difference-smmoths-1.png" alt="Estimated differences of trends in sediment Hg concentration for pairs of Scottish lochs" data-lazy-loaded="true" style="display: inline;" width="456" height="342" src-orig="https://i0.wp.com/www.fromthebottomoftheheap.net/assets/img/posts/difference-smooths-i-plot-difference-smmoths-1.png?w=456" scale="1.375"><noscript>&lt;img src="<a class="vglnk" href="https://i0.wp.com/www.fromthebottomoftheheap.net/assets/img/posts/difference-smooths-i-plot-difference-smmoths-1.png?w=456" rel="nofollow"><span>https</span><span>://</span><span>i0</span><span>.</span><span>wp</span><span>.</span><span>com</span><span>/</span><span>www</span><span>.</span><span>fromthebottomoftheheap</span><span>.</span><span>net</span><span>/</span><span>assets</span><span>/</span><span>img</span><span>/</span><span>posts</span><span>/</span><span>difference</span><span>-</span><span>smooths</span><span>-</span><span>i</span><span>-</span><span>plot</span><span>-</span><span>difference</span><span>-</span><span>smmoths</span><span>-</span><span>1</span><span>.</span><span>png</span><span>?</span><span>w</span><span>=</span><span>456</span></a>" alt="Estimated differences of trends in sediment Hg concentration for pairs of Scottish lochs" data-recalc-dims="1" /&gt;</noscript><p></p>
<figcaption>
Estimated differences of trends in sediment Hg concentration for pairs of Scottish lochs<br>
</figcaption>
</figure>
<p>
Where the confidence interval excludes zero, we might infer significant differences between a pari of estimated smooths.
</p>
<h2 id="conclusions">
Conclusions<br>
</h2>
<p>
Regular readers will be familiar with the <span class="math inline">(Xp)</span> matrix; I’ve used this for simulating from the posterior distribution of an estimated GAM, and for computing simultaneous intervals for smoothers, among other things. Here, it is used to compute difference between smooths. The <span class="math inline">(Xp)</span> matrix is quite versatile; learning how to use it effectively will allow you to compute all manner of derived quantities related to an estimated GAM.
</p>
<p>
The <code>by</code>-variable type of factor-smooth interaction is just one of the ways of estimating different smooth effects for each level of a factor. One of the potential disadvantages of this type of smoother is it is quite wasteful to estimate three different smooths, each with its own smoothness parameter. More parsimonious ways of fitting factor-smooth interactions are possible with <strong>mgcv</strong>, and I’ll look at an alternative option in the next post.
</p>
<h3 id="references" class="unnumbered">
References<br>
</h3>
<div id="refs" class="references">
<div id="ref-Rose2012-pl">
<p>
Rose, N. L., Yang, H., Turner, S. D., and Simpson, G. L. (2012). An assessment of the mechanisms for the transfer of lead and mercury from atmospherically contaminated organic soils to lake sediments with particular reference to scotland, UK. <em>Geochimica et cosmochimica acta</em> 82, 113–135. doi:<a href="https://doi.org/10.1016/j.gca.2010.12.026" rel="nofollow" target="_blank">10.1016/j.gca.2010.12.026</a>.
</p>
</div>
</div>

		<script type="text/javascript">
		  var vglnk = { key: '949efb41171ac6ec1bf7f206d57e90b8' };

		  (function(d, t) {
			var s = d.createElement(t); s.type = 'text/javascript'; s.async = true;
			s.src = '//cdn.viglink.com/api/vglnk.js';
			var r = d.getElementsByTagName(t)[0]; r.parentNode.insertBefore(s, r);
		  }(document, 'script'));
		</script>		
		
<div id="jp-relatedposts" class="jp-relatedposts" style="display: block;">
	<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
<div class="jp-relatedposts-items jp-relatedposts-items-visual jp-relatedposts-grid "><div class="jp-relatedposts-post jp-relatedposts-post0 jp-relatedposts-post-thumbs" data-post-id="152978" data-post-format="false"><a class="jp-relatedposts-post-a" href="https://www.r-bloggers.com/generalized-addictive-models-and-mixed-effects-in-agriculture/" title="Generalized Additive Models and Mixed-Effects in Agriculture

IntroductionIn the previous post I explored the use of linear model in the forms most commonly used in agricultural research.Clearly, when we are talking about linear models we are implicitly assuming that all relations between the dependent variable y and the predictors x are linear. In fact, in a linear…" rel="nofollow" data-origin="155893" data-position="0"><img class="jp-relatedposts-post-img" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/Eq1.png" width="137" alt="Generalized Additive Models and Mixed-Effects in Agriculture" height="9" srcset="https://i0.wp.com/1.bp.blogspot.com/-5CUyerAemSk/WWM4a8H_IXI/AAAAAAAAXfs/HKOwmlyTtY8RwFyAH8QQu0Ll22aUS3qfwCLcBGAs/s640/Eq1.png?zoom=1.5625&amp;resize=137%2C8&amp;ssl=1" src-orig="https://i0.wp.com/1.bp.blogspot.com/-5CUyerAemSk/WWM4a8H_IXI/AAAAAAAAXfs/HKOwmlyTtY8RwFyAH8QQu0Ll22aUS3qfwCLcBGAs/s640/Eq1.png?resize=350%2C200&amp;ssl=1" scale="1.375"></a><h4 class="jp-relatedposts-post-title"><a class="jp-relatedposts-post-a" href="https://www.r-bloggers.com/generalized-addictive-models-and-mixed-effects-in-agriculture/" title="Generalized Additive Models and Mixed-Effects in Agriculture

IntroductionIn the previous post I explored the use of linear model in the forms most commonly used in agricultural research.Clearly, when we are talking about linear models we are implicitly assuming that all relations between the dependent variable y and the predictors x are linear. In fact, in a linear…" rel="nofollow" data-origin="155893" data-position="0">Generalized Additive Models and Mixed-Effects in Agriculture</a></h4><p class="jp-relatedposts-post-excerpt">IntroductionIn the previous post I explored the use of linear model in the forms most commonly used in agricultural research.Clearly, when we are talking about linear models we are implicitly assuming that all relations between the dependent variable y and the predictors x are linear. In fact, in a linear…</p><p class="jp-relatedposts-post-date" style="display: block;">July 15, 2017</p><p class="jp-relatedposts-post-context">In "R bloggers"</p></div><div class="jp-relatedposts-post jp-relatedposts-post1 jp-relatedposts-post-thumbs" data-post-id="150061" data-post-format="false"><a class="jp-relatedposts-post-a" href="https://www.r-bloggers.com/fitting-count-and-zero-inflated-count-glmms-with-mgcv/" title="Fitting count and zero-inflated count GLMMs with mgcv

A couple of days ago, Molly Brooks and coauthors posted a preprint on BioRχiv illustrating the use of the glmmTMB R package for fitting zero-inflated GLMMs (Brooks et al., 2017). In the paper, glmmTMB is compared with several other GLMM-fitting packages. mgcv has recently gained the ability to fit a…" rel="nofollow" data-origin="155893" data-position="1"><img class="jp-relatedposts-post-img" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/compare-mgcv-with-glmmtmb-salamander-nb2-coefs-1.png" width="137" alt="Fitting count and zero-inflated count GLMMs with mgcv" height="78" srcset="https://i2.wp.com/www.fromthebottomoftheheap.net/assets/img/posts/compare-mgcv-with-glmmtmb-salamander-nb2-coefs-1.png?zoom=1.5625&amp;resize=137%2C78" src-orig="https://i2.wp.com/www.fromthebottomoftheheap.net/assets/img/posts/compare-mgcv-with-glmmtmb-salamander-nb2-coefs-1.png?resize=350%2C200" scale="1.375"></a><h4 class="jp-relatedposts-post-title"><a class="jp-relatedposts-post-a" href="https://www.r-bloggers.com/fitting-count-and-zero-inflated-count-glmms-with-mgcv/" title="Fitting count and zero-inflated count GLMMs with mgcv

A couple of days ago, Molly Brooks and coauthors posted a preprint on BioRχiv illustrating the use of the glmmTMB R package for fitting zero-inflated GLMMs (Brooks et al., 2017). In the paper, glmmTMB is compared with several other GLMM-fitting packages. mgcv has recently gained the ability to fit a…" rel="nofollow" data-origin="155893" data-position="1">Fitting count and zero-inflated count GLMMs with mgcv</a></h4><p class="jp-relatedposts-post-excerpt">A couple of days ago, Molly Brooks and coauthors posted a preprint on BioRχiv illustrating the use of the glmmTMB R package for fitting zero-inflated GLMMs (Brooks et al., 2017). In the paper, glmmTMB is compared with several other GLMM-fitting packages. mgcv has recently gained the ability to fit a…</p><p class="jp-relatedposts-post-date" style="display: block;">May 4, 2017</p><p class="jp-relatedposts-post-context">In "R bloggers"</p></div><div class="jp-relatedposts-post jp-relatedposts-post2 jp-relatedposts-post-thumbs" data-post-id="146467" data-post-format="false"><a class="jp-relatedposts-post-a" href="https://www.r-bloggers.com/modelling-extremes-using-generalized-additive-models/" title="Modelling extremes using generalized additive models

Quite some years ago, whilst working on the EU Sixth Framework project Euro-limpacs, I organized a workshop on statistical methods for analyzing time series data. One of the sessions was on the analysis of extremes, ably given by Paul Northrop (UCL Department of Statistical Science). That intro certainly whet my…" rel="nofollow" data-origin="155893" data-position="2"><img class="jp-relatedposts-post-img" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/modelling-extremes-with-gams-post-1-packages-and-plot-1.png" width="137" alt="Modelling extremes using generalized additive models" height="78" srcset="https://i0.wp.com/www.fromthebottomoftheheap.net/assets/img/posts/modelling-extremes-with-gams-post-1-packages-and-plot-1.png?zoom=1.5625&amp;resize=137%2C78" src-orig="https://i0.wp.com/www.fromthebottomoftheheap.net/assets/img/posts/modelling-extremes-with-gams-post-1-packages-and-plot-1.png?resize=350%2C200" scale="1.375"></a><h4 class="jp-relatedposts-post-title"><a class="jp-relatedposts-post-a" href="https://www.r-bloggers.com/modelling-extremes-using-generalized-additive-models/" title="Modelling extremes using generalized additive models

Quite some years ago, whilst working on the EU Sixth Framework project Euro-limpacs, I organized a workshop on statistical methods for analyzing time series data. One of the sessions was on the analysis of extremes, ably given by Paul Northrop (UCL Department of Statistical Science). That intro certainly whet my…" rel="nofollow" data-origin="155893" data-position="2">Modelling extremes using generalized additive models</a></h4><p class="jp-relatedposts-post-excerpt">Quite some years ago, whilst working on the EU Sixth Framework project Euro-limpacs, I organized a workshop on statistical methods for analyzing time series data. One of the sessions was on the analysis of extremes, ably given by Paul Northrop (UCL Department of Statistical Science). That intro certainly whet my…</p><p class="jp-relatedposts-post-date" style="display: block;">January 25, 2017</p><p class="jp-relatedposts-post-context">In "R bloggers"</p></div></div></div><aside class="mashsb-container mashsb-main mashsb-stretched"><div class="mashsb-box"><div class="mashsb-buttons"><a class="mashicon-facebook mash-small mash-center mashsb-noshadow" href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fwww.r-bloggers.com%2Fcomparing-smooths-in-factor-smooth-interactions-i%2F" target="_blank" rel="nofollow"><span class="icon"></span><span class="text">Share</span></a><a class="mashicon-twitter mash-small mash-center mashsb-noshadow" href="https://twitter.com/intent/tweet?text=Comparing%20smooths%20in%20factor-smooth%20interactions%20I&amp;url=https://www.r-bloggers.com/comparing-smooths-in-factor-smooth-interactions-i/&amp;via=Rbloggers" target="_blank" rel="nofollow"><span class="icon"></span><span class="text">Tweet</span></a><div class="onoffswitch2 mash-small mashsb-noshadow" style="display:none;"></div></div>
            </div>
                <div style="clear:both;"></div></aside>
            <!-- Share buttons by mashshare.net - Version: 3.4.4-->
<p class="syndicated-attribution">
</p><div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;">
<div style="text-align: center;">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href="http://www.fromthebottomoftheheap.net/2017/10/10/difference-splines-i/"> From the Bottom of the Heap - R</a></strong>.</div>
<hr>
<a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers.com</a> offers <strong><a href="https://feedburner.google.com/fb/a/mailverify?uri=RBloggers" rel="nofollow">daily e-mail updates</a></strong> about <a title="The R Project for Statistical Computing" href="https://www.r-project.org/" rel="nofollow">R</a> news and <a title="R tutorials" href="https://www.r-bloggers.com/search/tutorial" rel="nofollow">tutorials</a> on topics such as: <a title="Data science" href="https://www.r-bloggers.com/search/data%20science" rel="nofollow">Data science</a>, <a title="Big Data" href="https://www.r-bloggers.com/search/Big%20Data" rel="nofollow">Big Data, </a><a title="R jobs" href="https://www.r-users.com/" rel="nofollow">R jobs</a>, visualization (<a title="ggplot and ggplot2 tutorials" href="https://www.r-bloggers.com/search/ggplot2" rel="nofollow">ggplot2</a>, <a title="Boxplots using lattice and ggplot2 tutorials" href="https://www.r-bloggers.com/search/boxplot" rel="nofollow">Boxplots</a>, <a title="Maps and gis" href="https://www.r-bloggers.com/search/map" rel="nofollow">maps</a>, <a title="Animation in R" href="https://www.r-bloggers.com/search/animation" rel="nofollow">animation</a>), programming (<a title="RStudio IDE for R" href="https://www.r-bloggers.com/search/RStudio" rel="nofollow">RStudio</a>, <a title="Sweave and literate programming" href="https://www.r-bloggers.com/search/sweave" rel="nofollow">Sweave</a>, <a title="LaTeX in R" href="https://www.r-bloggers.com/search/LaTeX" rel="nofollow">LaTeX</a>, <a title="SQL and databases" href="https://www.r-bloggers.com/search/SQL" rel="nofollow">SQL</a>, <a title="Eclipse IDE for R" href="https://www.r-bloggers.com/search/eclipse" rel="nofollow">Eclipse</a>, <a title="git and github, Version Control System" href="https://www.r-bloggers.com/search/git" rel="nofollow">git</a>, <a title="Large data in R using Hadoop" href="https://www.r-bloggers.com/search/hadoop" rel="nofollow">hadoop</a>, <a title="Web Scraping of google, facebook, yahoo, twitter and more using R" href="https://www.r-bloggers.com/search/Web+Scraping" rel="nofollow">Web Scraping</a>) statistics (<a title="Regressions and ANOVA analysis tutorials" href="https://www.r-bloggers.com/search/regression" rel="nofollow">regression</a>, <a title="principal component analysis tutorial" href="https://www.r-bloggers.com/search/PCA" rel="nofollow">PCA</a>, <a title="Time series" href="https://www.r-bloggers.com/search/time+series" rel="nofollow">time series</a>, <a title="finance trading" href="https://www.r-bloggers.com/search/trading" rel="nofollow">trading</a>) and more...
</div><p></p><hr><hr>
<div style="border: 1px solid #EB9349; background: none repeat scroll 0 0 #FDEADA; text-align: center; margin: 10px; font-size: 16px;">
If you got this far, why not <strong><u>subscribe for updates</u> </strong>from the site?  Choose your flavor: <a href="http://feedburner.google.com/fb/a/mailverify?uri=RBloggers" rel="nofollow">e-mail</a>, <a href="https://twitter.com/#!/rbloggers" rel="nofollow">twitter</a>, <a href="http://feeds.feedburner.com/RBloggers" rel="nofollow">RSS</a>, or <a href="http://www.facebook.com/pages/R-bloggers/191414254890" rel="nofollow">facebook</a>...
</div><div class="social4i" style="height:29px;"><div class="social4in" style="height:29px;float: left;"><div class="socialicons s4fblike" style="float:left;margin-right: 10px;"><div class="fb-like fb_iframe_widget" data-href="https://www.r-bloggers.com/comparing-smooths-in-factor-smooth-interactions-i/" data-send="true" data-layout="button_count" data-width="100" data-height="21" data-show-faces="false" fb-xfbml-state="rendered" fb-iframe-plugin-query="app_id=&amp;container_width=0&amp;height=21&amp;href=https%3A%2F%2Fwww.r-bloggers.com%2Fcomparing-smooths-in-factor-smooth-interactions-i%2F&amp;layout=button_count&amp;locale=en_US&amp;sdk=joey&amp;send=true&amp;show_faces=false&amp;width=100"><span style="vertical-align: bottom; width: 112px; height: 20px;"><iframe name="f18cbca52ef09" width="100px" height="21px" frameborder="0" allowtransparency="true" allowfullscreen="true" scrolling="no" title="fb:like Facebook Social Plugin" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/like(1).html" style="border: none; visibility: visible; width: 112px; height: 20px;" class=""></iframe></span></div></div><div class="socialicons s4linkedin" style="float:left;margin-right: 10px;"><span class="IN-widget" style="line-height: 1; vertical-align: baseline; display: inline-block; text-align: center;"><span style="padding: 0px !important; margin: 0px !important; text-indent: 0px !important; display: inline-block !important; vertical-align: baseline !important; font-size: 1px !important;"><span id="li_ui_li_gen_1507763867644_2"><a id="li_ui_li_gen_1507763867644_2-link" href="javascript:void(0);"><span id="li_ui_li_gen_1507763867644_2-logo">in</span><span id="li_ui_li_gen_1507763867644_2-title"><span id="li_ui_li_gen_1507763867644_2-mark"></span><span id="li_ui_li_gen_1507763867644_2-title-text">Share</span></span></a></span></span><span style="padding: 0px !important; margin: 0px !important; text-indent: 0px !important; display: inline-block !important; vertical-align: baseline !important; font-size: 1px !important;"><span id="li_ui_li_gen_1507763867649_3-container" class="IN-right"><span id="li_ui_li_gen_1507763867649_3" class="IN-right"><span id="li_ui_li_gen_1507763867649_3-inner" class="IN-right"><span id="li_ui_li_gen_1507763867649_3-content" class="IN-right">1</span></span></span></span></span></span><script type="in/share+init" data-url="https://www.r-bloggers.com/comparing-smooths-in-factor-smooth-interactions-i/" data-counter="right"></script></div></div><div style="clear:both"></div></div></div>

	</div><!-- #post-## -->



   				<div id="comments">


<div id="comment-user-details">





		<p class="nocomments">Comments are closed.</p>



</div>

</div><!-- #comments -->

       
	</div>
    <!-- begin second sidebar -->
    <div id="secondsidebar">

		
		<div class="side-widget"><h2>Search R-bloggers</h2><div class="wgs_wrapper"><div id="___gcse_0"><div class="gsc-control-cse gsc-control-cse-en"><div class="gsc-control-wrapper-cse" dir="ltr"><form class="gsc-search-box gsc-search-box-tools" accept-charset="utf-8"><table cellspacing="0" cellpadding="0" class="gsc-search-box"><tbody><tr><td class="gsc-input"><div class="gsc-input-box" id="gsc-iw-id1"><table cellspacing="0" cellpadding="0" id="gs_id50" class="gstl_50 " style="width: 100%; padding: 0px;"><tbody><tr><td id="gs_tti50" class="gsib_a"><input autocomplete="off" type="text" size="10" class="gsc-input" name="search" title="search" id="gsc-i-id1" style="width: 100%; padding: 0px; border: none; margin: 0px; height: auto; outline: none; background: url(&quot;https://www.google.com/cse/static/images/1x/googlelogo_lightgrey_46x16dp.png&quot;) left center no-repeat rgb(255, 255, 255); text-indent: 48px;" x-webkit-speech="" x-webkit-grammar="builtin:search" lang="en" dir="ltr" spellcheck="false" placeholder="Custom Search"></td><td class="gsib_b"><div class="gsst_b" id="gs_st50" dir="ltr"><a class="gsst_a" href="javascript:void(0)" style="display: none;"><span class="gscb_a" id="gs_cb50">×</span></a></div></td></tr></tbody></table></div><input type="hidden" name="bgresponse" id="bgresponse"></td><td class="gsc-search-button"><input type="image" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/search_box_icon.png" class="gsc-search-button gsc-search-button-v2" title="search"></td><td class="gsc-clear-button"><div class="gsc-clear-button" title="clear results">&nbsp;</div></td></tr></tbody></table><table cellspacing="0" cellpadding="0" class="gsc-branding"><tbody><tr><td class="gsc-branding-user-defined"></td><td class="gsc-branding-text"><div class="gsc-branding-text">powered by</div></td><td class="gsc-branding-img"><img src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/googlelogo_grey_46x15dp.png" class="gsc-branding-img" srcset="https://www.google.com/cse/static/images/2x/googlelogo_grey_46x15dp.png 2x" scale="0"></td></tr></tbody></table></form><div class="gsc-results-wrapper-overlay"><div class="gsc-results-close-btn" tabindex="0"></div><div class="gsc-tabsAreaInvisible"><div class="gsc-tabHeader gsc-inline-block gsc-tabhActive">Web</div><span class="gs-spacer"> </span><div tabindex="0" class=" gsc-tabHeader gsc-tabhInactive gsc-inline-block">Image</div><span class="gs-spacer"> </span></div><div class="gsc-refinementsAreaInvisible"></div><div class="gsc-above-wrapper-area-invisible"><table cellspacing="0" cellpadding="0" class="gsc-above-wrapper-area-container"><tbody><tr><td class="gsc-result-info-container"><div class="gsc-result-info-invisible"></div></td><td class="gsc-orderby-container"><div class="gsc-orderby-invisible"><div class="gsc-orderby-label gsc-inline-block">Sort by:</div><div class="gsc-option-menu-container gsc-inline-block"><div class="gsc-selected-option-container gsc-inline-block"><div class="gsc-selected-option">Relevance</div><div class="gsc-option-selector"></div></div><div class="gsc-option-menu-invisible"><div class="gsc-option-menu-item gsc-option-menu-item-highlighted"><div class="gsc-option">Relevance</div></div><div class="gsc-option-menu-item"><div class="gsc-option">Date</div></div></div></div></div></td></tr></tbody></table></div><div class="gsc-adBlockInvisible"></div><div class="gsc-wrapper"><div class="gsc-adBlockInvisible"></div><div class="gsc-resultsbox-invisible"><div class="gsc-resultsRoot gsc-tabData gsc-tabdActive"><table cellspacing="0" cellpadding="0" class="gsc-resultsHeader"><tbody><tr><td class="gsc-twiddleRegionCell"><div class="gsc-twiddle"><div class="gsc-title">Web</div></div><div class="gsc-stats"></div><div class="gsc-results-selector gsc-all-results-active"><div class="gsc-result-selector gsc-one-result" title="show one result">&nbsp;</div><div class="gsc-result-selector gsc-more-results" title="show more results">&nbsp;</div><div class="gsc-result-selector gsc-all-results" title="show all results">&nbsp;</div></div></td><td class="gsc-configLabelCell"></td></tr></tbody></table><div><div class="gsc-expansionArea"></div></div></div><div class="gsc-resultsRoot gsc-tabData gsc-tabdInactive"><table cellspacing="0" cellpadding="0" class="gsc-resultsHeader"><tbody><tr><td class="gsc-twiddleRegionCell"><div class="gsc-twiddle"><div class="gsc-title">Image</div></div><div class="gsc-stats"></div><div class="gsc-results-selector gsc-all-results-active"><div class="gsc-result-selector gsc-one-result" title="show one result">&nbsp;</div><div class="gsc-result-selector gsc-more-results" title="show more results">&nbsp;</div><div class="gsc-result-selector gsc-all-results" title="show all results">&nbsp;</div></div></td><td class="gsc-configLabelCell"></td></tr></tbody></table><div><div class="gsc-expansionArea"></div></div></div></div></div></div><div class="gsc-modal-background-image" tabindex="0"></div></div></div></div></div></div><div class="side-widget"><h2>Recent popular posts</h2><ul>				<li>
										<a href="https://www.r-bloggers.com/rstudio-v1-1-released/" class="bump-view" data-bump-view="tp">
						RStudio v1.1 Released					</a>
									</li>
							<li>
										<a href="https://www.r-bloggers.com/genome-wide-association-studies-in-r/" class="bump-view" data-bump-view="tp">
						Genome-wide association studies in R					</a>
									</li>
			</ul></div><div class="side-widget"><h2>Most visited articles of the week</h2>
<ol class="wppp_list">
	<li><a href="https://www.r-bloggers.com/rstudio-v1-1-released/" title="RStudio v1.1 Released">RStudio v1.1 Released</a></li>
	<li><a href="https://www.r-bloggers.com/how-to-write-the-first-for-loop-in-r/" title="How to write the first for loop in R">How to write the first for loop in R</a></li>
	<li><a href="https://www.r-bloggers.com/installing-r-packages/" title="Installing R packages">Installing R packages</a></li>
	<li><a href="https://www.r-bloggers.com/how-to-make-a-histogram-with-basic-r/" title="How to Make a Histogram with Basic R">How to Make a Histogram with Basic R</a></li>
	<li><a href="https://www.r-bloggers.com/using-apply-sapply-lapply-in-r/" title="Using apply, sapply, lapply in R">Using apply, sapply, lapply in R</a></li>
	<li><a href="https://www.r-bloggers.com/how-to-perform-a-logistic-regression-in-r/" title="How to perform a Logistic Regression in R">How to perform a Logistic Regression in R</a></li>
	<li><a href="https://www.r-bloggers.com/how-to-learn-r-2/" title="Tutorials for learning R">Tutorials for learning R</a></li>
	<li><a href="https://www.r-bloggers.com/writing-academic-articles-using-r-markdown-and-latex/" title="Writing academic articles using R Markdown and LaTeX">Writing academic articles using R Markdown and LaTeX</a></li>
	<li><a href="https://www.r-bloggers.com/in-depth-introduction-to-machine-learning-in-15-hours-of-expert-videos/" title="In-depth introduction to machine learning in 15 hours of expert videos">In-depth introduction to machine learning in 15 hours of expert videos</a></li>
</ol>
</div><div class="side-widget"><h2>Sponsors</h2>			<div class="textwidget"><script data-cfasync="false" type="text/javascript">
// https://support.cloudflare.com/hc/en-us/articles/200169436-How-can-I-have-Rocket-Loader-ignore-my-script-s-in-Automatic-Mode-
// this must be placed higher. Otherwise it doesn't work.
// data-cfasync="false" is for making sure cloudflares' rocketcache doesn't interfeare with this
// in this case it only works because it was used at the original script in the text widget


function createCookie(name,value,days) {
    var expires = "";
    if (days) {
        var date = new Date();
        date.setTime(date.getTime() + (days*24*60*60*1000));
        expires = "; expires=" + date.toUTCString();
    }
    document.cookie = name + "=" + value + expires + "; path=/";
}

function readCookie(name) {
    var nameEQ = name + "=";
    var ca = document.cookie.split(';');
    for(var i=0;i < ca.length;i++) {
        var c = ca[i];
        while (c.charAt(0)==' ') c = c.substring(1,c.length);
        if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
    }
    return null;
}

function eraseCookie(name) {
    createCookie(name,"",-1);
}


function readTextFile(file)
{
	// Helps people browse between pages without the need to keep downloading the same 
	// ads txt page everytime. This way, it allows them to use their browser's cache.
	var random_number = readCookie("ad_random_number_cookie");
	if(random_number == null) {
		var random_number = Math.floor(Math.random()*100*(new Date().getTime()/1000));
		createCookie("ad_random_number_cookie",random_number,1)
	}
	
    file += '?t='+random_number;
    var rawFile = new XMLHttpRequest();
    rawFile.onreadystatechange = function ()
    {
        if(rawFile.readyState === 4)
        {
            if(rawFile.status === 200 || rawFile.status == 0)
            {
                // var allText = rawFile.responseText;
                // document.write(allText);
                document.write(rawFile.responseText);
            }
        }
    }
    rawFile.open("GET", file, false);
    rawFile.send(null);
}

// readTextFile('https://raw.githubusercontent.com/Raynos/file-store/master/temp.txt');

readTextFile("https://www.r-bloggers.com/wp-content/uploads/text-widget_anti-cache.txt");

</script><a href="https://earlconf.com/" rel="nofollow" target="_blank" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;outbound-widget-ads&#39;, &#39;http://www.mango-solutions.com&#39;, &#39;mango-solutions.com&#39;]);">
<img src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/EARL-Tickets-Rbloggers-ad.png" alt="Mango solutions" scale="0">
</a>



<br><hr>
<a href="https://www.datacamp.com/courses/free-introduction-to-r/?tap_a=5644-dce66f&amp;tap_s=10907-287229" rel="nofollow" target="_blank" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;outbound-widget-ads&#39;, &#39;https://www.datacamp.com/courses/free-introduction-to-r/?tap_a=5644-dce66f&amp;tap_s=10907-287229&#39;, &#39;datacamp.com&#39;]);">
<img src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/ads_dc.001.jpeg" scale="0">
</a>





<br><hr>
<a href="https://plotcon.plot.ly/workshops" rel="nofollow" target="_blank" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;outbound-widget-ads&#39;, &#39;https://plotcon.plot.ly/workshops&#39;, &#39;plot.ly&#39;]);">
<img src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/2017-09-05-masterclass-r-shiny-dash-plotly-01.png" scale="0">
</a>








<br><hr>

<a href="https://www.rstudio.com/products/connect/?utm_source=rblogger&amp;utm_medium=connectbannertosite&amp;utm_campaign=connect" rel="nofollow" target="_blank" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;outbound-widget-ads&#39;, &#39;https://www.rstudio.com/products/connect/?utm_source=rblogger&amp;utm_medium=connectbannertosite&amp;utm_campaign=connect&#39;, &#39;rstudio.com&#39;]);">
    <img src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/RStudioConnect.png" alt="" title="RStudio" scale="0">
</a>



<br><hr>
<a href="http://www.highstat.com/" rel="nofollow" target="_blank" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;outbound-widget-ads&#39;, &#39;http://www.highstat.com/&#39;, &#39;highstat.com&#39;]);">
<img src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/SouthamptBanffV3.jpg" alt="Zero Inflated Models and Generalized Linear Mixed Models with R" scale="0">
</a>





<br><hr>
<a href="http://www.statisticsviews.com/view/index.html?utm_source=RBlogger&amp;utm_medium=banner&amp;utm_term=StatViews&amp;utm_content=StatViewsAd&amp;utm_campaign=webbanner" rel="nofollow" target="_blank" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;outbound-widget-ads&#39;, &#39;http://www.statisticsviews.com/view/index.html?utm_source=RBlogger&amp;utm_medium=banner&amp;utm_term=StatViews&amp;utm_content=StatViewsAd&amp;utm_campaign=webbanner&#39;, &#39;statisticsviews.com&#39;]);">
<img src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/291316_300x125_Final-Web-Ready.jpg" scale="0">
</a>




<br><hr>
<a href="http://www.quantide.com/" rel="nofollow" target="_blank" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;outbound-widget-ads&#39;, &#39;https://www.quantide.com&#39;, &#39;quantide.com&#39;]);">
<img src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/quantide-2016-04-15.png" alt="Quantide: statistical consulting and training" scale="0">
</a>



<br><hr>
<a href="https://hubs.ly/H08L4p90" rel="nofollow" target="_blank" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;outbound-widget-ads&#39;, &#39;https://www.odsc.com/california&#39;, &#39;odsc.com/california&#39;]);">
<img src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/RB-West-clouds_300x125.png" alt="ODSC2" scale="0">
</a>



<br><hr>
<a href="https://hubs.ly/H08L4470" rel="nofollow" target="_blank" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;outbound-widget-ads&#39;, &#39;https://www.odsc.com/london&#39;, &#39;odsc.com/london&#39;]);">
<img src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/XaI-West.png" alt="ODSC1" scale="0">
</a>








<br><hr>
<a href="http://www.datasociety.co/coursedescriptions/?utm_medium=advert&amp;utm_source=rbloggers&amp;utm_campaign=august3" rel="nofollow" target="_blank" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;outbound-widget-ads&#39;, &#39;http://www.datasociety.co/coursedescriptions/?utm_medium=advert&amp;utm_source=rbloggers&amp;utm_campaign=august3&#39;, &#39;datasociety.co&#39;]);">
<img src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/Rbloggers_Data-Society-300-125.png" alt="datasociety" scale="0">
</a>




<br><hr>
<a href="http://www.eoda.de/de/R-Kenntnis-Tage.html" rel="nofollow" target="_blank" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;outbound-widget-ads&#39;, &#39;http://www.eoda.de/de/R-Kenntnis-Tage.html&#39;, &#39;eoda.de/de/R-Kenntnis-Tage.html&#39;]);"> 
<img src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/R-Kenntnis-Tage_eodaGmbH-1.png" alt="http://www.eoda.de" scale="0">
</a>







<br><hr>
<a href="http://fantasyfootballanalytics.net/" rel="nofollow" target="_blank" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;outbound-widget-ads&#39;, &#39;http://fantasyfootballanalytics.net/&#39;, &#39;fantasyfootballanalytics.net&#39;]);">
<img src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/FFA-Banner.jpg" scale="0">
</a>








<br><hr>
<a href="http://info.nycdatascience.com/become-a-data-scientist-in-12-week-nyc-data-science-bootcamp-r-blogger" rel="nofollow" target="_blank" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;outbound-widget-ads&#39;, &#39;http://info.nycdatascience.com/become-a-data-scientist-in-12-week-nyc-data-science-bootcamp-r-blogger&#39;, &#39;nycdatascience.com&#39;]);">
<img src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/r-blogger-NYCDSA-300-125-2016-05-02.png" alt="" title="" scale="0">
</a>



<br><hr>
<a href="https://www.crcpress.com/go/r_programming_freebook?utm_source=banner_ad&amp;utm_medium=banner&amp;utm_campaign=170200604" rel="nofollow" target="_blank" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;outbound-widget-ads&#39;, &#39;https://www.crcpress.com/go/r_programming_freebook?utm_source=banner_ad&amp;utm_medium=banner&amp;utm_campaign=170200604&#39;, &#39;crcpress.com&#39;]);">
    <img src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/R-Blogger-Banner-Ad_v2-2017-02-03.png" alt="CRC R books series" title="CRC R books series" scale="0">
</a>





<br><hr>
<a href="http://www.jumpingrivers.com/?utm_source=rbloggers&amp;utm_campaign=1&amp;utm_medium=banner" rel="nofollow" target="_blank" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;outbound-widget-ads&#39;, &#39;http://www.jumpingrivers.com/&#39;, &#39;jumpingrivers.com&#39;]);">
    <img src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/jr-AD300_125.jpg" alt="" title="STATWORX" scale="0">
</a>




<br><hr>
<a href="http://www.statworx.de/r-statistik/" rel="nofollow" target="_blank" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;outbound-widget-ads&#39;, &#39;http://www.statworx.de/r-statistik/&#39;, &#39;statworx.de&#39;]);">
    <img src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/STATWORX-R-Bloggers.png" alt="" title="STATWORX" scale="0">
</a>


<br><hr>
<a href="http://yottamine.com/try-yottamine-now" rel="nofollow" target="_blank" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;outbound-widget-ads&#39;, &#39;http://yottamine.com/try-yottamine-now&#39;, &#39;yottamine.com&#39;]);">
    <img src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/R-Blog_Speed.png" alt="" title="yottamine" scale="0">
</a>




<br><hr>
<a href="http://www.6sigma.us/six-sigma-online-training.php" rel="nofollow" target="_blank" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;outbound-widget-ads&#39;, &#39;http://www.6sigma.us/six-sigma-online-training.php&#39;, &#39;6sigma.us&#39;]);">
    <img src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/sixsigma300x125-1.jpg" alt="Six Sigma Online Training" title="6 sigma" scale="0">
</a>




<br><hr>
<a href="https://www.udemy.com/courses/?pmtag=&amp;utm_source=growth-affiliate&amp;utm_medium=linkshare&amp;utm_term=eO5bByfCCNo&amp;utm_content=&amp;utm_campaign=_._pn_eO5bByfCCNo_._ci__._ex_Y_._&amp;siteID=eO5bByfCCNo-HqFY4iAUIhzjwVKLZLftGA&amp;LSNPUBID=eO5bByfCCNo" rel="nofollow" target="_blank" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;outbound-widget-ads&#39;, &#39;https://www.udemy.com/courses/?pmtag=&amp;utm_source=growth-affiliate&amp;utm_medium=linkshare&amp;utm_term=eO5bByfCCNo&amp;utm_content=&amp;utm_campaign=_._pn_eO5bByfCCNo_._ci__._ex_Y_._&amp;siteID=eO5bByfCCNo-HqFY4iAUIhzjwVKLZLftGA&amp;LSNPUBID=eO5bByfCCNo&#39;, &#39;linksynergy.com - udemy&#39;]);">
    <img src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/R-Bloggers-300x125-1.png" alt="" title="R in Udemy" scale="0">
</a>



<br><hr>
<a href="https://www.statcon.de/shop/de/kurse/r" rel="nofollow" target="_blank" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;outbound-widget-ads&#39;, &#39;https://www.statcon.de/shop/de/kurse/r&#39;, &#39;statcon.de&#39;]);">
    <img src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/2017-07-29-statcon.de-rect4634.png" alt="statcon.de" title="statcon.de" scale="0">
</a>



<br><hr>
<a href="https://mljar.com/" rel="nofollow" target="_blank" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;outbound-widget-ads&#39;, &#39;https://mljar.com/&#39;, &#39;mljar.com&#39;]);">
    <img src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/mljar_300x125.jpg" alt="mljar.com" title="mljar.com" scale="0">
</a>




<br><br><hr>



<script type="text/javascript" data-cfasync="false">
// https://support.cloudflare.com/hc/en-us/articles/200169436-How-can-I-have-Rocket-Loader-ignore-my-script-s-in-Automatic-Mode-
// this must be placed higher. Otherwise it doesn't work.
// data-cfasync="false" is for making sure cloudflares' rocketcache doesn't interfeare with this
// in this case it only works because it was used at the original script in the text widget

// document.write("<p>text1");
/* VRTZ JS   300 x 250 pagead  DO NOT MODIFY  */
document.write('<s'+'cript src="//banner.vrtzads.com/scripts/pageads.js?vzId=VZJ130060V994954&vzR='+Math.floor(Math.random()*100*(new Date().getTime()/1000))+'"></s'+'cript>');
// document.write("text2</p>");
</script><script src="https://banner.vrtzads.com/scripts/pageads.js?vzId=VZJ130060V994954&amp;vzR=3079132194"></script>



<br><hr>
<p>
<a href="https://www.r-bloggers.com/contact-us/" rel="nofollow" target="_blank" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;outbound-widget-ads&#39;, &#39;https://www.r-bloggers.com/contact-us/&#39;, &#39;r-bloggers.com/contact-us&#39;]);">Contact us </a> if you wish to help support R-bloggers, and place <strong>your banner here</strong>.
</p>




<!-- Google Analytics -->
<script>
// https://developers.google.com/analytics/devguides/collection/analyticsjs/

(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-419807-53', 'auto');
// ga('send', 'pageview');
</script>
<!-- End Google Analytics -->






</div>
		</div><div class="side-widget"><h2><a class="rsswidget" href="https://feeds.feedburner.com/Rjobs"><img class="rss-widget-icon" style="border:0" width="14" height="14" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/rss.png" alt="RSS" scale="0"></a> <a class="rsswidget" href="https://www.r-users.com/">Jobs for R users</a></h2><ul><li><a class="rsswidget" href="http://feedproxy.google.com/~r/RJobs/~3/f0ldKrD49UA/">PROGRAMMER/SOFTWARE DEVELOPMENT ENGINEER/COMPUTATIONAL AND MACHINE LEARNING SPECIALIST</a></li><li><a class="rsswidget" href="http://feedproxy.google.com/~r/RJobs/~3/OMCwwBo1veo/">Quantitative Econometrician @ San Francisco, California, U.S.</a></li><li><a class="rsswidget" href="http://feedproxy.google.com/~r/RJobs/~3/X3DpiECQ8DE/">Postdoctoral Research Fellow in Healthcare Systems Engineering @ Maryland, U.S.</a></li><li><a class="rsswidget" href="http://feedproxy.google.com/~r/RJobs/~3/xPASaTEn8kE/">R Programmer &amp; Statistician for Academic Research</a></li><li><a class="rsswidget" href="http://feedproxy.google.com/~r/RJobs/~3/8QL91gt7zzc/">Data Scientist</a></li><li><a class="rsswidget" href="http://feedproxy.google.com/~r/RJobs/~3/oyehz_z-zrw/">Postdoctoral Data Scientist: GIS and mHealth</a></li><li><a class="rsswidget" href="http://feedproxy.google.com/~r/RJobs/~3/5q4Hn0zGhbQ/">Data Scientist @ London</a></li></ul></div><div class="side-widget">			<div class="textwidget"><strong><a href="https://www.r-bloggers.com/blogs-list/">Full list of contributing R-bloggers</a></strong></div>
		</div>    </div>
<!-- end second sidebar --></div>
<!-- begin footer -->
<div id="footer">
	<strong><a href="https://www.r-bloggers.com/">R-bloggers</a></strong> was founded by <a href="http://www.r-statistics.com/about/">Tal Galili</a>, with gratitude to the <a href="http://www.r-project.org/">R</a> community.  <br>
    Is powered by <a href="http://www.wordpress.org/">WordPress</a> using a <a href="http://themes.bavotasan.com/" rel="nofollow">bavotasan.com</a> design.<br>
    Copyright © 2017 <strong>R-bloggers</strong>. All Rights Reserved. <a href="http://www.r-bloggers.com/terms/">Terms and Conditions</a> for this website<br>
</div>

<!--
TPC! Memory Usage (http://webjawns.com)
Memory Usage: 65696752
Memory Peak Usage: 65995728
WP Memory Limit: 820M
PHP Memory Limit: 800M
Checkpoints: 11
-->

		<div class="wpusb wpusb-buttons wpusb-fixed-right   wpusb-fixed wpusb-layout-buttons-content wpusb-fixed-position_fixed" id="wpusb-container-fixed" data-element-url="https%3A%2F%2Fwww.r-bloggers.com%2Fcomparing-smooths-in-factor-smooth-interactions-i%2F%3Futm_source%3Dshare_buttons%26utm_medium%3Dsocial_media%26utm_campaign%3Dsocial_share" data-element-title="Comparing%20smooths%20in%20factor-smooth%20interactions%20I" data-attr-reference="155893" data-is-term="0" data-element="fixed" data-attr-nonce="e592a48c3f" data-disabled-share-counts="1" data-wpusb-component="counter-social-share">

			<div data-element="buttons" class="wpusb-fixed-right-container ">
						<div class="wpusb-item wpusb-facebook ">

				<a href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fwww.r-bloggers.com%2Fcomparing-smooths-in-factor-smooth-interactions-i%2F%3Futm_source%3Dshare_buttons%26utm_medium%3Dsocial_media%26utm_campaign%3Dsocial_share" target="_blank" data-action="open-popup" class="wpusb-layout-buttons wpusb-button wpusb-btn " title="Share on Facebook" rel="nofollow">

				   <i class="wpusb-icon-facebook-buttons "></i>
				</a>
			</div>			<div class="wpusb-item wpusb-twitter ">

				<a href="https://twitter.com/share?url=https%3A%2F%2Fwww.r-bloggers.com%2Fcomparing-smooths-in-factor-smooth-interactions-i%2F%3Futm_source%3Dshare_buttons%26utm_medium%3Dsocial_media%26utm_campaign%3Dsocial_share&amp;text=Comparing%20smooths%20in%20factor-smooth%20interactions%20I%20#rstats #datascience&amp;via=rbloggers" target="_blank" data-action="open-popup" class="wpusb-layout-buttons wpusb-button wpusb-btn " title="Tweet" rel="nofollow">

				   <i class="wpusb-icon-twitter-buttons "></i>
				</a>
			</div>			<div class="wpusb-item wpusb-linkedin ">

				<a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Fwww.r-bloggers.com%2Fcomparing-smooths-in-factor-smooth-interactions-i%2F%3Futm_source%3Dshare_buttons%26utm_medium%3Dsocial_media%26utm_campaign%3Dsocial_share&amp;title=Comparing%20smooths%20in%20factor-smooth%20interactions%20I" target="_blank" data-action="open-popup" class="wpusb-layout-buttons wpusb-button wpusb-btn " title="Share on Linkedin" rel="nofollow">

				   <i class="wpusb-icon-linkedin-buttons "></i>
				</a>
			</div>			<div class="wpusb-item wpusb-google-plus ">

				<a href="https://plus.google.com/share?url=https%3A%2F%2Fwww.r-bloggers.com%2Fcomparing-smooths-in-factor-smooth-interactions-i%2F%3Futm_source%3Dshare_buttons%26utm_medium%3Dsocial_media%26utm_campaign%3Dsocial_share" target="_blank" data-action="open-popup" class="wpusb-layout-buttons wpusb-button wpusb-btn " title="Share on Google+" rel="nofollow">

				   <i class="wpusb-icon-google-plus-buttons "></i>
				</a>
			</div>				</div>
				<span class="wpusb-toggle" data-action="close-buttons"></span>
			</div>    <script>
        var snp_f = [];
        var snp_hostname = new RegExp(location.host);
        var snp_http = new RegExp("^(http|https)://", "i");
        var snp_cookie_prefix = '';
        var snp_separate_cookies = false;
        var snp_ajax_url = 'https://www.r-bloggers.com/wp-admin/admin-ajax.php';
        var snp_ignore_cookies = false;
        var snp_enable_analytics_events = false;
        var snp_enable_mobile = false;
        var snp_use_in_all = false;
        var snp_excluded_urls = [];
        snp_excluded_urls.push('');    </script>
    <div class="snp-root">
        <input type="hidden" id="snp_popup" value="">
        <input type="hidden" id="snp_popup_id" value="">
        <input type="hidden" id="snp_popup_theme" value="">
        <input type="hidden" id="snp_exithref" value="">
        <input type="hidden" id="snp_exittarget" value="">
    	<div id="snppopup-welcome" class="snp-pop-109583 snppopup"><input type="hidden" class="snp_open" value="scroll"><input type="hidden" class="snp_show_on_exit" value="2"><input type="hidden" class="snp_exit_js_alert_text" value=""><input type="hidden" class="snp_open_scroll" value="50"><input type="hidden" class="snp_optin_redirect_url" value=""><input type="hidden" class="snp_show_cb_button" value="yes"><input type="hidden" class="snp_popup_id" value="109583"><input type="hidden" class="snp_popup_theme" value="theme6"><input type="hidden" class="snp_overlay" value="disabled"><input type="hidden" class="snp_cookie_conversion" value="30"><input type="hidden" class="snp_cookie_close" value="180"><div class="snp-fb snp-theme6">
    <div class="snp-subscribe-inner">
	<h1 class="snp-header"><i>Never miss an update! </i>
<br>
<strong>Subscribe to R-bloggers</strong> to receive <br>e-mails with the latest R posts.<br>

<small>(You will not see this message again.)</small></h1>	<div class="snp-form">
	    <form action="https://feedburner.google.com/fb/a/mailverify?uri=RBloggers" method="post" class="snp-subscribeform snp_subscribeform">
				<fieldset>
		    <div class="snp-field">
			<input type="text" name="email" id="snp_email" placeholder="Your E-mail..." class="snp-field snp-field-email">		
		    </div>
		    <button type="submit" class="snp-submit">Submit</button>
		</fieldset>
	    </form>
	</div>
	<a href="https://www.r-bloggers.com/comparing-smooths-in-factor-smooth-interactions-i/#" class="snp_nothanks snp-close">Click here to close (This popup will not appear again)</a>    </div>
    </div>
<style>.snp-pop-109583 .snp-theme6 { max-width: 700px;}
.snp-pop-109583 .snp-theme6 h1 {font-size: 17px;}
.snp-pop-109583 .snp-theme6 { color: #a0a4a9;}
.snp-pop-109583 .snp-theme6 .snp-field ::-webkit-input-placeholder { color: #a0a4a9;}
.snp-pop-109583 .snp-theme6 .snp-field :-moz-placeholder { color: #a0a4a9;}
.snp-pop-109583 .snp-theme6 .snp-field :-ms-input-placeholder { color: #a0a4a9;}
.snp-pop-109583  .snp-theme6 .snp-field input { border: 1px solid #a0a4a9;}
.snp-pop-109583 .snp-theme6 .snp-field { color: #000000;}
.snp-pop-109583 .snp-theme6 { background: #f2f2f2;}
</style></div>    </div>
    <script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/shCore.js.download"></script>
<script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/shBrushAS3.js.download"></script>
<script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/shBrushBash.js.download"></script>
<script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/shBrushColdFusion.js.download"></script>
<script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/shBrushClojure.js.download"></script>
<script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/shBrushCpp.js.download"></script>
<script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/shBrushCSharp.js.download"></script>
<script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/shBrushCss.js.download"></script>
<script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/shBrushDelphi.js.download"></script>
<script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/shBrushDiff.js.download"></script>
<script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/shBrushErlang.js.download"></script>
<script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/shBrushFSharp.js.download"></script>
<script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/shBrushGroovy.js.download"></script>
<script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/shBrushJava.js.download"></script>
<script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/shBrushJavaFX.js.download"></script>
<script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/shBrushJScript.js.download"></script>
<script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/shBrushLatex.js.download"></script>
<script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/shBrushMatlabKey.js.download"></script>
<script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/shBrushObjC.js.download"></script>
<script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/shBrushPerl.js.download"></script>
<script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/shBrushPhp.js.download"></script>
<script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/shBrushPlain.js.download"></script>
<script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/shBrushPowerShell.js.download"></script>
<script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/shBrushPython.js.download"></script>
<script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/shBrushR.js.download"></script>
<script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/shBrushRuby.js.download"></script>
<script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/shBrushScala.js.download"></script>
<script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/shBrushSql.js.download"></script>
<script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/shBrushVb.js.download"></script>
<script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/shBrushXml.js.download"></script>
<script type="text/javascript">
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "https://www.r-bloggers.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.9b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "https://www.r-bloggers.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.9b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();
</script>
<link rel="stylesheet" id="wpusb-style-css" href="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/style(1).css" type="text/css" media="all">
<script type="text/javascript">
/* <![CDATA[ */
var scriptParams = {"google_search_engine_id":"005359090438081006639:paz69t-s8ua"};
/* ]]> */
</script>
<script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/google_cse_v2.js.download"></script>
<script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/jquery.ck.min.js.download"></script>
<script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/ninjapopups.min.js.download"></script>
<script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/jquery.fancybox.min.js.download"></script>
<script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/comment-reply.min.js.download"></script>
<script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/effects.js.download"></script>
<script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/photon.js.download"></script>
<script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/devicepx-jetpack.js.download"></script>
<script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/jquery.sonar.min.js.download"></script>
<script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/lazy-load.js.download"></script>
<script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/wp-embed.min.js.download"></script>
	<div id="fb-root" class=" fb_reset"><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div></div></div><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div><iframe name="fb_xdm_frame_https" frameborder="0" allowtransparency="true" allowfullscreen="true" scrolling="no" id="fb_xdm_frame_https" aria-hidden="true" title="Facebook Cross Domain Communication Frame" tabindex="-1" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/K6RbmRhg2m2.html" style="border: none;"></iframe></div></div></div>
	<script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/widgets.js.download"></script><script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/all.js.download"></script><script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/plusone.js.download" gapi_processed="true"></script><script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/in.js.download"></script><script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/e-201741.js.download" async="" defer=""></script>
<script type="text/javascript">
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:4.7.1',blog:'11524731',post:'155893',tz:'-6',srv:'www.r-bloggers.com'} ]);
	_stq.push([ 'clickTrackerInit', '11524731', '155893' ]);
</script>
<script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/effects.js(1).download"></script> 
<script type="text/javascript">
/* <![CDATA[ */
jQuery(function(){
	jQuery("ul.sf-menu").supersubs({ 
		minWidth:    12,
		maxWidth:    27,
		extraWidth:  1
	}).superfish({ 
		delay:       100,
		speed:       250 
	});	});
/* ]]> */
</script>





<!-- Dynamic page generated in 0.832 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2017-10-10 23:57:17 -->

<!-- Compression = gzip --><script type="text/javascript" src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/MathJax.js(1).download"></script><script id="texAllTheThingsPageScript" type="text/javascript" src="chrome-extension://cbimabofgmfdkicghcadidpemeenbffn/js/pageScript.js" inlinemath="[[&quot;$&quot;,&quot;$&quot;],[&quot;[;&quot;,&quot;;]&quot;]]" displaymath="[[&quot;$$&quot;,&quot;$$&quot;],[&quot;\\[&quot;,&quot;\\]&quot;]]"></script><table cellspacing="0" cellpadding="0" class="gstl_50 gssb_c" style="width: 193px; display: none; top: 288px; position: absolute; left: 719px;"><tbody><tr><td class="gssb_f"></td><td class="gssb_e" style="width: 100%;"></td></tr></tbody></table><img src="./Comparing smooths in factor-smooth interactions I _ R-bloggers_files/g.gif" alt=":)" width="6" height="5" id="wpstats" scale="0"></body></html>